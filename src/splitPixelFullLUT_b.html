<!DOCTYPE html>
<!-- Generated by Cython 0.21.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21.1</p>
<p>Raw output: <a href="splitPixelFullLUT_b.c">splitPixelFullLUT_b.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: <span class="c">#!/usr/bin/env python</span></pre>
<pre class='cython code score-11'>  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: <span class="c"># -*- coding: utf-8 -*-</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;004: <span class="c">#    Project: Fast Azimuthal Integration</span></pre>
<pre class='cython line score-0'>&#xA0;005: <span class="c">#             https://github.com/pyFAI/pyFAI</span></pre>
<pre class='cython line score-0'>&#xA0;006: <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;007: <span class="c">#    Copyright (C) European Synchrotron Radiation Facility, Grenoble, France</span></pre>
<pre class='cython line score-0'>&#xA0;008: <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;009: <span class="c">#    Principal author:       Jérôme Kieffer (Jerome.Kieffer@ESRF.eu)</span></pre>
<pre class='cython line score-0'>&#xA0;010: <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;011: <span class="c">#   This program is free software: you can redistribute it and/or modify</span></pre>
<pre class='cython line score-0'>&#xA0;012: <span class="c">#   it under the terms of the GNU General Public License as published by</span></pre>
<pre class='cython line score-0'>&#xA0;013: <span class="c">#   the Free Software Foundation, either version 3 of the License, or</span></pre>
<pre class='cython line score-0'>&#xA0;014: <span class="c">#   (at your option) any later version.</span></pre>
<pre class='cython line score-0'>&#xA0;015: <span class="c"># </span></pre>
<pre class='cython line score-0'>&#xA0;016: <span class="c">#   This program is distributed in the hope that it will be useful,</span></pre>
<pre class='cython line score-0'>&#xA0;017: <span class="c">#   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
<pre class='cython line score-0'>&#xA0;018: <span class="c">#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
<pre class='cython line score-0'>&#xA0;019: <span class="c">#   GNU General Public License for more details.</span></pre>
<pre class='cython line score-0'>&#xA0;020: <span class="c"># </span></pre>
<pre class='cython line score-0'>&#xA0;021: <span class="c">#   You should have received a copy of the GNU General Public License</span></pre>
<pre class='cython line score-0'>&#xA0;022: <span class="c">#   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
<pre class='cython line score-0'>&#xA0;023: <span class="c">#</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+024: <span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_doc, __pyx_kp_s_Full_pixel_Splitting_implemente) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;025: <span class="s">Full pixel Splitting implemented using Sparse-matrix Dense-Vector multiplication,</span></pre>
<pre class='cython line score-0'>&#xA0;026: <span class="s">Sparse matrix represented using the CompressedSparseROw.</span></pre>
<pre class='cython line score-0'>&#xA0;027: <span class="s">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+028: <span class="n">__author__</span> <span class="o">=</span> <span class="s">&quot;Jerome Kieffer&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_author, __pyx_kp_s_Jerome_Kieffer) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+029: <span class="n">__contact__</span> <span class="o">=</span> <span class="s">&quot;Jerome.kieffer@esrf.fr&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_contact, __pyx_kp_s_Jerome_kieffer_esrf_fr) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+030: <span class="n">__date__</span> <span class="o">=</span> <span class="s">&quot;20/10/2014&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_date, __pyx_kp_s_20_10_2014) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+031: <span class="n">__status__</span> <span class="o">=</span> <span class="s">&quot;stable&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_status, __pyx_n_s_stable) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+032: <span class="n">__license__</span> <span class="o">=</span> <span class="s">&quot;GPLv3+&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_license, __pyx_kp_s_GPLv3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;033: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+034: <span class="k">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span></pre>
<pre class='cython code score-16'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_os, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;035: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">import</span> <span class="n">prange</span></pre>
<pre class='cython line score-0'>&#xA0;036: <span class="k">from</span> <span class="nn">libc.string</span> <span class="k">cimport</span> <span class="n">memset</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+037: <span class="k">import</span> <span class="nn">numpy</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;038: <span class="k">cimport</span> <span class="nn">numpy</span></pre>
<pre class='cython line score-0'>&#xA0;039: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fabs</span><span class="p">,</span> <span class="n">M_PI</span><span class="p">,</span> <span class="n">floor</span></pre>
<pre class='cython line score-0'>&#xA0;040: <span class="k">from</span> <span class="nn">libc.stdio</span> <span class="k">cimport</span> <span class="n">printf</span></pre>
<pre class='cython line score-0'>&#xA0;041: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+042: <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">pi</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span> <span class="n">M_PI</span></pre>
<pre class='cython code score-0'>  __pyx_v_19splitPixelFullLUT_b_pi = ((float)M_PI);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+043: <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">onef</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_19splitPixelFullLUT_b_onef = ((float)1.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+044: <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
    /*try:*/ {
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+045:     <span class="k">from</span> <span class="nn">fastcrc</span> <span class="k">import</span> <span class="n">crc32</span></pre>
<pre class='cython code score-24'>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L2_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_crc32);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_crc32);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_crc32);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_fastcrc, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L2_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_5, __pyx_n_s_crc32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L2_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_crc32, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L2_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L9_try_end;
    __pyx_L2_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+046: <span class="k">except</span><span class="p">:</span></pre>
<pre class='cython code score-4'>    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_1, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L4_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class='cython line score-26' onclick='toggleDiv(this)'>+047:     <span class="k">from</span> <span class="nn">zlib</span> <span class="k">import</span> <span class="n">crc32</span></pre>
<pre class='cython code score-26'>      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L4_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_crc32);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_n_s_crc32);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_crc32);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_zlib, __pyx_t_7, -1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L4_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_8, __pyx_n_s_crc32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L4_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_crc32, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L4_except_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L3_exception_handled;
    }
    __pyx_L4_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    goto __pyx_L1_error;
    __pyx_L3_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
    __pyx_L9_try_end:;
  }
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+048: <span class="n">EPS32</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span></pre>
<pre class='cython code score-49'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_eps);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_float_1_0, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_EPS32, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;049: </pre>
<pre class='cython line score-0'>&#xA0;050: </pre>
<pre class='cython line score-0'>&#xA0;051: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+052: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">Function</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_19splitPixelFullLUT_b_Function {
  double slope;
  double intersect;
};
</pre><pre class='cython line score-0'>&#xA0;053:     <span class="n">double</span> <span class="n">slope</span></pre>
<pre class='cython line score-0'>&#xA0;054:     <span class="n">double</span> <span class="n">intersect</span></pre>
<pre class='cython line score-0'>&#xA0;055: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+056: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">area4</span><span class="p">(</span><span class="n">double</span> <span class="n">a0</span><span class="p">,</span> <span class="n">double</span> <span class="n">a1</span><span class="p">,</span> <span class="n">double</span> <span class="n">b0</span><span class="p">,</span> <span class="n">double</span> <span class="n">b1</span><span class="p">,</span> <span class="n">double</span> <span class="n">c0</span><span class="p">,</span> <span class="n">double</span> <span class="n">c1</span><span class="p">,</span> <span class="n">double</span> <span class="n">d0</span><span class="p">,</span> <span class="n">double</span> <span class="n">d1</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static double __pyx_f_19splitPixelFullLUT_b_area4(double __pyx_v_a0, double __pyx_v_a1, double __pyx_v_b0, double __pyx_v_b1, double __pyx_v_c0, double __pyx_v_c1, double __pyx_v_d0, double __pyx_v_d1) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;057:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;058: <span class="sd">    Calculate the area of the ABCD quadrilataire  with corners:</span></pre>
<pre class='cython line score-0'>&#xA0;059: <span class="sd">    A(a0,a1)</span></pre>
<pre class='cython line score-0'>&#xA0;060: <span class="sd">    B(b0,b1)</span></pre>
<pre class='cython line score-0'>&#xA0;061: <span class="sd">    C(c0,c1)</span></pre>
<pre class='cython line score-0'>&#xA0;062: <span class="sd">    D(d0,d1)</span></pre>
<pre class='cython line score-0'>&#xA0;063: <span class="sd">    @return: area, i.e. 1/2 * (AC ^ BD)</span></pre>
<pre class='cython line score-0'>&#xA0;064: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+065:     <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fabs</span><span class="p">(((</span><span class="n">c0</span> <span class="o">-</span> <span class="n">a0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d1</span> <span class="o">-</span> <span class="n">b1</span><span class="p">))</span> <span class="o">-</span> <span class="p">((</span><span class="n">c1</span> <span class="o">-</span> <span class="n">a1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d0</span> <span class="o">-</span> <span class="n">b0</span><span class="p">)))</span></pre>
<pre class='cython code score-0'>  __pyx_r = (0.5 * fabs((((__pyx_v_c0 - __pyx_v_a0) * (__pyx_v_d1 - __pyx_v_b1)) - ((__pyx_v_c1 - __pyx_v_a1) * (__pyx_v_d0 - __pyx_v_b0)))));
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;066: </pre>
<pre class='cython line score-0'>&#xA0;067: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+068: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">getBinNr</span><span class="p">(</span> <span class="n">double</span> <span class="n">x0</span><span class="p">,</span> <span class="n">double</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">double</span> <span class="n">delta</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE double __pyx_f_19splitPixelFullLUT_b_getBinNr(double __pyx_v_x0, double __pyx_v_pos0_min, double __pyx_v_delta) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;069:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;070: <span class="sd">    calculate the bin number for any point</span></pre>
<pre class='cython line score-0'>&#xA0;071: <span class="sd">    param x0: current position</span></pre>
<pre class='cython line score-0'>&#xA0;072: <span class="sd">    param pos0_min: position minimum</span></pre>
<pre class='cython line score-0'>&#xA0;073: <span class="sd">    param delta: bin width</span></pre>
<pre class='cython line score-0'>&#xA0;074: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+075:     <span class="k">return</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">pos0_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta</span></pre>
<pre class='cython code score-0'>  __pyx_r = ((__pyx_v_x0 - __pyx_v_pos0_min) / __pyx_v_delta);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;076: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+077: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">integrate</span><span class="p">(</span> <span class="n">double</span> <span class="n">A0</span><span class="p">,</span> <span class="n">double</span> <span class="n">B0</span><span class="p">,</span> <span class="n">Function</span> <span class="n">AB</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static double __pyx_f_19splitPixelFullLUT_b_integrate(double __pyx_v_A0, double __pyx_v_B0, struct __pyx_t_19splitPixelFullLUT_b_Function __pyx_v_AB) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;078:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;079: <span class="sd">    integrates the line defined by AB, from A0 to B0</span></pre>
<pre class='cython line score-0'>&#xA0;080: <span class="sd">    param A0: first limit</span></pre>
<pre class='cython line score-0'>&#xA0;081: <span class="sd">    param B0: second limit</span></pre>
<pre class='cython line score-0'>&#xA0;082: <span class="sd">    param AB: struct with the slope and point of intersection of the line</span></pre>
<pre class='cython line score-0'>&#xA0;083: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+084:     <span class="k">if</span> <span class="n">A0</span><span class="o">==</span><span class="n">B0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_A0 == __pyx_v_B0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+085:         <span class="k">return</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0.0;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;086:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+087:         <span class="k">return</span> <span class="n">AB</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="p">(</span><span class="n">B0</span><span class="o">*</span><span class="n">B0</span> <span class="o">-</span> <span class="n">A0</span><span class="o">*</span><span class="n">A0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">AB</span><span class="o">.</span><span class="n">intersect</span><span class="o">*</span><span class="p">(</span><span class="n">B0</span><span class="o">-</span><span class="n">A0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = (((__pyx_v_AB.slope * ((__pyx_v_B0 * __pyx_v_B0) - (__pyx_v_A0 * __pyx_v_A0))) * 0.5) + (__pyx_v_AB.intersect * (__pyx_v_B0 - __pyx_v_A0)));
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;088: </pre>
<pre class='cython line score-0'>&#xA0;089: </pre>
<pre class='cython line score-18' onclick='toggleDiv(this)'>+090: <span class="k">class</span> <span class="nc">HistoLUT1dFullSplit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre>
<pre class='cython code score-18'>  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_object);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_builtin_object);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_builtin_object);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = __Pyx_Py3MetaclassPrepare(__pyx_t_5, __pyx_t_6, __pyx_n_s_HistoLUT1dFullSplit, __pyx_n_s_HistoLUT1dFullSplit, (PyObject *) NULL, __pyx_n_s_splitPixelFullLUT_b, __pyx_kp_s_Now_uses_CSR_Compressed_Sparse);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/* … */
  __pyx_t_8 = __Pyx_Py3ClassCreate(__pyx_t_5, __pyx_n_s_HistoLUT1dFullSplit, __pyx_t_6, __pyx_t_7, NULL, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_HistoLUT1dFullSplit, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-0'>&#xA0;091:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;092: <span class="sd">    Now uses CSR (Compressed Sparse raw) with main attributes:</span></pre>
<pre class='cython line score-0'>&#xA0;093: <span class="sd">    * nnz: number of non zero elements</span></pre>
<pre class='cython line score-0'>&#xA0;094: <span class="sd">    * data: coefficient of the matrix in a 1D vector of float64</span></pre>
<pre class='cython line score-0'>&#xA0;095: <span class="sd">    * indices: Column index position for the data (same size as  </span></pre>
<pre class='cython line score-0'>&#xA0;096: <span class="sd">    * indptr: row pointer indicates the start of a given row. len nrow+1</span></pre>
<pre class='cython line score-0'>&#xA0;097: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;098: <span class="sd">    Nota: nnz = indptr[-1]</span></pre>
<pre class='cython line score-0'>&#xA0;099: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;100:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-49' onclick='toggleDiv(this)'>+101:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span></pre>
<pre class='cython code score-49'>/* Python wrapper */
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_19splitPixelFullLUT_b_19HistoLUT1dFullSplit___init__[] = "\n        @param pos: 3D or 4D array with the coordinates of each pixel point\n        @param bins: number of output bins, 100 by default\n        @param pos0Range: minimum and maximum  of the 2th range\n        @param pos1Range: minimum and maximum  of the chi range\n        @param mask: array (of int8) with masked pixels with 1 (0=not masked)\n        @param allow_pos0_neg: enforce the q&lt;0 is usually not possible  \n        @param unit: can be 2th_deg or r_nm^-1 ...\n        ";
static PyMethodDef __pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_1__init__ = {"__init__", (PyCFunction)__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_19splitPixelFullLUT_b_19HistoLUT1dFullSplit___init__};
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyArrayObject *__pyx_v_pos = 0;
  int __pyx_v_bins;
  PyObject *__pyx_v_pos0Range = 0;
  PyObject *__pyx_v_pos1Range = 0;
  PyObject *__pyx_v_mask = 0;
  PyObject *__pyx_v_mask_checksum = 0;
  PyObject *__pyx_v_allow_pos0_neg = 0;
  PyObject *__pyx_v_unit = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_pos,&amp;__pyx_n_s_bins,&amp;__pyx_n_s_pos0Range,&amp;__pyx_n_s_pos1Range,&amp;__pyx_n_s_mask,&amp;__pyx_n_s_mask_checksum,&amp;__pyx_n_s_allow_pos0_neg,&amp;__pyx_n_s_unit,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyArrayObject *__pyx_v_pos, int __pyx_v_bins, PyObject *__pyx_v_pos0Range, PyObject *__pyx_v_pos1Range, PyObject *__pyx_v_mask, PyObject *__pyx_v_mask_checksum, PyObject *__pyx_v_allow_pos0_neg, PyObject *__pyx_v_unit) {
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_pos);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b.HistoLUT1dFullSplit.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_pos);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_self, __pyx_n_s_pos, __pyx_n_s_bins, __pyx_n_s_pos0Range, __pyx_n_s_pos1Range, __pyx_n_s_mask, __pyx_n_s_mask_checksum, __pyx_n_s_allow_pos0_neg, __pyx_n_s_unit, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_None));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)Py_None));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_None));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_None));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)Py_None));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_None));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_None));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, ((PyObject *)Py_None));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_None));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_None));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, ((PyObject *)Py_None));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_None));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, ((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_s_undefined));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 6, ((PyObject*)__pyx_n_s_undefined));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_s_undefined));
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_1__init__, 0, __pyx_n_s_HistoLUT1dFullSplit___init, NULL, __pyx_n_s_splitPixelFullLUT_b, __pyx_d, ((PyObject *)__pyx_codeobj__34));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_8, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_7, __pyx_n_s_init, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_kieffer_workspace_pyFAI_sr, __pyx_n_s_init, 101, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;102:                  <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+103:                  <span class="nb">int</span> <span class="n">bins</span><span class="o">=</span><span class="mf">100</span><span class="p">,</span></pre>
<pre class='cython code score-2'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)100));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+104:                  <span class="n">pos0Range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-0'>    values[3] = ((PyObject *)((PyObject *)Py_None));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+105:                  <span class="n">pos1Range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-0'>    values[4] = ((PyObject *)((PyObject *)Py_None));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+106:                  <span class="n">mask</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-0'>    values[5] = ((PyObject *)((PyObject *)Py_None));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+107:                  <span class="n">mask_checksum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-0'>    values[6] = ((PyObject *)((PyObject *)Py_None));
</pre><pre class='cython line score-83' onclick='toggleDiv(this)'>+108:                  <span class="n">allow_pos0_neg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span></pre>
<pre class='cython code score-83'>    values[7] = ((PyObject *)((PyObject *)Py_False));
    values[8] = ((PyObject *)((PyObject*)__pyx_n_s_undefined));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 9, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_bins);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pos0Range);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pos1Range);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mask);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mask_checksum);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_allow_pos0_neg);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_unit);
          if (value) { values[8] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_pos = ((PyArrayObject *)values[1]);
    if (values[2]) {
      __pyx_v_bins = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_bins == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_bins = ((int)((int)100));
    }
    __pyx_v_pos0Range = values[3];
    __pyx_v_pos1Range = values[4];
    __pyx_v_mask = values[5];
    __pyx_v_mask_checksum = values[6];
    __pyx_v_allow_pos0_neg = values[7];
    __pyx_v_unit = values[8];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b.HistoLUT1dFullSplit.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_pos), __pyx_ptype_5numpy_ndarray, 0, "pos", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit___init__(__pyx_self, __pyx_v_self, __pyx_v_pos, __pyx_v_bins, __pyx_v_pos0Range, __pyx_v_pos1Range, __pyx_v_mask, __pyx_v_mask_checksum, __pyx_v_allow_pos0_neg, __pyx_v_unit);
</pre><pre class='cython line score-0'>&#xA0;109:                  <span class="n">unit</span><span class="o">=</span><span class="s">&quot;undefined&quot;</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;110:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;111: <span class="sd">        @param pos: 3D or 4D array with the coordinates of each pixel point</span></pre>
<pre class='cython line score-0'>&#xA0;112: <span class="sd">        @param bins: number of output bins, 100 by default</span></pre>
<pre class='cython line score-0'>&#xA0;113: <span class="sd">        @param pos0Range: minimum and maximum  of the 2th range</span></pre>
<pre class='cython line score-0'>&#xA0;114: <span class="sd">        @param pos1Range: minimum and maximum  of the chi range</span></pre>
<pre class='cython line score-0'>&#xA0;115: <span class="sd">        @param mask: array (of int8) with masked pixels with 1 (0=not masked)</span></pre>
<pre class='cython line score-0'>&#xA0;116: <span class="sd">        @param allow_pos0_neg: enforce the q&lt;0 is usually not possible  </span></pre>
<pre class='cython line score-0'>&#xA0;117: <span class="sd">        @param unit: can be 2th_deg or r_nm^-1 ...</span></pre>
<pre class='cython line score-0'>&#xA0;118: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;119: </pre>
<pre class='cython line score-0'>&#xA0;120: <span class="c">#        self.padding = int(padding)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+121:         <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mf">3</span><span class="p">:</span> <span class="c">#create a view</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_pos-&gt;nd &gt; 3) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-18' onclick='toggleDiv(this)'>+122:             <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-18'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_pos), __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_int_4, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_pos, ((PyArrayObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple_);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+123:         <span class="k">assert</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">4</span></pre>
<pre class='cython code score-5'>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_pos-&gt;dimensions[1]) == 4) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+124:         <span class="k">assert</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">2</span></pre>
<pre class='cython code score-5'>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_pos-&gt;dimensions[2]) == 2) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+125:         <span class="k">assert</span> <span class="n">pos</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mf">3</span></pre>
<pre class='cython code score-5'>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!((__pyx_v_pos-&gt;nd == 3) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+126:         <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos, ((PyObject *)__pyx_v_pos)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+127:         <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_pos-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_size, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+128:         <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_bins);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+129:         <span class="bp">self</span><span class="o">.</span><span class="n">lut_size</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_lut_size, __pyx_int_0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+130:         <span class="bp">self</span><span class="o">.</span><span class="n">allow_pos0_neg</span> <span class="o">=</span> <span class="n">allow_pos0_neg</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_allow_pos0_neg, __pyx_v_allow_pos0_neg) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+131:         <span class="k">if</span>  <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_mask != Py_None);
  __pyx_t_4 = (__pyx_t_1 != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+132:             <span class="k">assert</span> <span class="n">mask</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-19'>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mask, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_4)) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    #endif
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+133:             <span class="bp">self</span><span class="o">.</span><span class="n">check_mask</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_check_mask, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+134:             <span class="bp">self</span><span class="o">.</span><span class="n">cmask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mask, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_6) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_cmask, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+135:             <span class="k">if</span> <span class="n">mask_checksum</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_mask_checksum);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_4) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+136:                 <span class="bp">self</span><span class="o">.</span><span class="n">mask_checksum</span> <span class="o">=</span> <span class="n">mask_checksum</span></pre>
<pre class='cython code score-2'>      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_mask_checksum, __pyx_v_mask_checksum) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;137:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-29' onclick='toggleDiv(this)'>+138:                 <span class="bp">self</span><span class="o">.</span><span class="n">mask_checksum</span> <span class="o">=</span> <span class="n">crc32</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span></pre>
<pre class='cython code score-29'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_crc32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_mask);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      } else {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mask);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_mask);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mask);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_mask_checksum, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_L5:;
    goto __pyx_L4;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;139:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+140:             <span class="bp">self</span><span class="o">.</span><span class="n">check_mask</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_check_mask, Py_False) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+141:             <span class="bp">self</span><span class="o">.</span><span class="n">mask_checksum</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_mask_checksum, Py_None) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L4:;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+142:         <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indptr</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-8'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_data, Py_None) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_nnz, Py_None) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_indices, Py_None) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_indptr, Py_None) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+143:         <span class="bp">self</span><span class="o">.</span><span class="n">pos0Range</span> <span class="o">=</span> <span class="n">pos0Range</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0Range, __pyx_v_pos0Range) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+144:         <span class="bp">self</span><span class="o">.</span><span class="n">pos1Range</span> <span class="o">=</span> <span class="n">pos1Range</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1Range, __pyx_v_pos1Range) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;145: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+146:         <span class="bp">self</span><span class="o">.</span><span class="n">calc_lut</span><span class="p">()</span></pre>
<pre class='cython code score-19'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_calc_lut);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-67' onclick='toggleDiv(this)'>+147:         <span class="bp">self</span><span class="o">.</span><span class="n">outPos</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos0_min</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0_maxin</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">)</span></pre>
<pre class='cython code score-67'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_min);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_delta);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_maxin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_delta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_9 = 1;
    }
  }
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (__pyx_t_6) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_8 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_outPos, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+148:         <span class="bp">self</span><span class="o">.</span><span class="n">lut_checksum</span> <span class="o">=</span> <span class="n">crc32</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></pre>
<pre class='cython code score-31'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_crc32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_lut_checksum, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+149:         <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_unit, __pyx_v_unit) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+150:         <span class="bp">self</span><span class="o">.</span><span class="n">lut</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">indptr</span><span class="p">)</span></pre>
<pre class='cython code score-17'>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_7 = 0;
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_lut, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='cython line score-71' onclick='toggleDiv(this)'>+151:         <span class="bp">self</span><span class="o">.</span><span class="n">lut_nbytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lut</span><span class="p">])</span></pre>
<pre class='cython code score-71'>  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_lut);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
    __pyx_t_2 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9 = 0;
    __pyx_t_11 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_11)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_11(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_i, __pyx_n_s_nbytes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_10, (PyObject*)__pyx_t_5))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_sum, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_lut_nbytes, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class='cython line score-0'>&#xA0;152: </pre>
<pre class='cython line score-0'>&#xA0;153: </pre>
<pre class='cython line score-0'>&#xA0;154:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;155:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;156:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-58' onclick='toggleDiv(this)'>+157:     <span class="k">def</span> <span class="nf">calc_lut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-58'>/* Python wrapper */
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_3calc_lut(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_3calc_lut = {"calc_lut", (PyCFunction)__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_3calc_lut, METH_O, 0};
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_3calc_lut(PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_lut (wrapper)", 0);
  __pyx_r = __pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_2calc_lut(__pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_2calc_lut(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyArrayObject *__pyx_v_cpos = 0;
  __Pyx_memviewslice __pyx_v_cmask = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_outMax = 0;
  PyArrayObject *__pyx_v_indptr = 0;
  double __pyx_v_pos0_min;
  CYTHON_UNUSED double __pyx_v_pos0_max;
  CYTHON_UNUSED double __pyx_v_pos0_maxin;
  double __pyx_v_pos1_min;
  CYTHON_UNUSED double __pyx_v_pos1_max;
  double __pyx_v_pos1_maxin;
  double __pyx_v_max0;
  double __pyx_v_min0;
  double __pyx_v_areaPixel;
  double __pyx_v_delta;
  double __pyx_v_A0;
  double __pyx_v_B0;
  double __pyx_v_C0;
  double __pyx_v_D0;
  double __pyx_v_A1;
  double __pyx_v_B1;
  double __pyx_v_C1;
  double __pyx_v_D1;
  double __pyx_v_A_lim;
  double __pyx_v_B_lim;
  double __pyx_v_C_lim;
  double __pyx_v_D_lim;
  CYTHON_UNUSED double __pyx_v_oneOverArea;
  double __pyx_v_partialArea;
  double __pyx_v_tmp;
  struct __pyx_t_19splitPixelFullLUT_b_Function __pyx_v_AB;
  struct __pyx_t_19splitPixelFullLUT_b_Function __pyx_v_BC;
  struct __pyx_t_19splitPixelFullLUT_b_Function __pyx_v_CD;
  struct __pyx_t_19splitPixelFullLUT_b_Function __pyx_v_DA;
  int __pyx_v_bins;
  CYTHON_UNUSED int __pyx_v_i;
  int __pyx_v_idx;
  int __pyx_v_bin;
  int __pyx_v_bin0_max;
  int __pyx_v_bin0_min;
  CYTHON_UNUSED int __pyx_v_pixel_bins;
  int __pyx_v_k;
  int __pyx_v_size;
  int __pyx_v_check_pos1;
  int __pyx_v_check_mask;
  PyArrayObject *__pyx_v_indices = 0;
  PyArrayObject *__pyx_v_data = 0;
  PyArrayObject *__pyx_v_areas = 0;
  double __pyx_v_oneOverPixelArea;
  CYTHON_UNUSED double __pyx_v_partialArea2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_areas;
  __Pyx_Buffer __pyx_pybuffer_areas;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_cpos;
  __Pyx_Buffer __pyx_pybuffer_cpos;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_data;
  __Pyx_Buffer __pyx_pybuffer_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indices;
  __Pyx_Buffer __pyx_pybuffer_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indptr;
  __Pyx_Buffer __pyx_pybuffer_indptr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_outMax;
  __Pyx_Buffer __pyx_pybuffer_outMax;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_lut", 0);
  __pyx_pybuffer_cpos.pybuffer.buf = NULL;
  __pyx_pybuffer_cpos.refcount = 0;
  __pyx_pybuffernd_cpos.data = NULL;
  __pyx_pybuffernd_cpos.rcbuffer = &amp;__pyx_pybuffer_cpos;
  __pyx_pybuffer_outMax.pybuffer.buf = NULL;
  __pyx_pybuffer_outMax.refcount = 0;
  __pyx_pybuffernd_outMax.data = NULL;
  __pyx_pybuffernd_outMax.rcbuffer = &amp;__pyx_pybuffer_outMax;
  __pyx_pybuffer_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_indptr.refcount = 0;
  __pyx_pybuffernd_indptr.data = NULL;
  __pyx_pybuffernd_indptr.rcbuffer = &amp;__pyx_pybuffer_indptr;
  __pyx_pybuffer_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_indices.refcount = 0;
  __pyx_pybuffernd_indices.data = NULL;
  __pyx_pybuffernd_indices.rcbuffer = &amp;__pyx_pybuffer_indices;
  __pyx_pybuffer_data.pybuffer.buf = NULL;
  __pyx_pybuffer_data.refcount = 0;
  __pyx_pybuffernd_data.data = NULL;
  __pyx_pybuffernd_data.rcbuffer = &amp;__pyx_pybuffer_data;
  __pyx_pybuffer_areas.pybuffer.buf = NULL;
  __pyx_pybuffer_areas.refcount = 0;
  __pyx_pybuffernd_areas.data = NULL;
  __pyx_pybuffernd_areas.rcbuffer = &amp;__pyx_pybuffer_areas;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b.HistoLUT1dFullSplit.calc_lut", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cpos);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cmask, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_outMax);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indptr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_areas);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(50, __pyx_n_s_self, __pyx_n_s_cpos, __pyx_n_s_cmask, __pyx_n_s_outMax, __pyx_n_s_indptr, __pyx_n_s_pos0_min, __pyx_n_s_pos0_max, __pyx_n_s_pos0_maxin, __pyx_n_s_pos1_min, __pyx_n_s_pos1_max, __pyx_n_s_pos1_maxin, __pyx_n_s_max0, __pyx_n_s_min0, __pyx_n_s_areaPixel, __pyx_n_s_delta, __pyx_n_s_A0, __pyx_n_s_B0, __pyx_n_s_C0, __pyx_n_s_D0, __pyx_n_s_A1, __pyx_n_s_B1, __pyx_n_s_C1, __pyx_n_s_D1, __pyx_n_s_A_lim, __pyx_n_s_B_lim, __pyx_n_s_C_lim, __pyx_n_s_D_lim, __pyx_n_s_oneOverArea, __pyx_n_s_partialArea, __pyx_n_s_tmp, __pyx_n_s_AB, __pyx_n_s_BC, __pyx_n_s_CD, __pyx_n_s_DA, __pyx_n_s_bins, __pyx_n_s_i, __pyx_n_s_idx, __pyx_n_s_bin, __pyx_n_s_bin0_max, __pyx_n_s_bin0_min, __pyx_n_s_pixel_bins, __pyx_n_s_k, __pyx_n_s_size, __pyx_n_s_check_pos1, __pyx_n_s_check_mask, __pyx_n_s_indices, __pyx_n_s_data, __pyx_n_s_areas, __pyx_n_s_oneOverPixelArea, __pyx_n_s_partialArea2);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/* … */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_3calc_lut, 0, __pyx_n_s_HistoLUT1dFullSplit_calc_lut, NULL, __pyx_n_s_splitPixelFullLUT_b, __pyx_d, ((PyObject *)__pyx_codeobj__36));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_7, __pyx_n_s_calc_lut, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 50, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_kieffer_workspace_pyFAI_sr, __pyx_n_s_calc_lut, 157, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+158:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">3</span><span class="p">]</span> <span class="n">cpos</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-39'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_cpos = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_cpos.diminfo[0].strides = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_cpos.diminfo[0].shape = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_cpos.diminfo[1].strides = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_cpos.diminfo[1].shape = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_cpos.diminfo[2].strides = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_cpos.diminfo[2].shape = __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.shape[2];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_cpos = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;159:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int8_t</span>[<span class="p">:]</span> <span class="n">cmask</span></pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+160:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">int32_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">outMax</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-39'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_outMax = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_outMax.diminfo[0].strides = __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_outMax.diminfo[0].shape = __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_outMax = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+161:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">int32_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">indptr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-45'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indptr = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_indptr.diminfo[0].strides = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indptr.diminfo[0].shape = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_indptr = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+162:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">pos0_min</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pos0_max</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pos0_maxin</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pos1_min</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pos1_max</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pos1_maxin</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_pos0_min = 0.0;
  __pyx_v_pos0_max = 0.0;
  __pyx_v_pos0_maxin = 0.0;
  __pyx_v_pos1_min = 0.0;
  __pyx_v_pos1_max = 0.0;
  __pyx_v_pos1_maxin = 0.0;
</pre><pre class='cython line score-0'>&#xA0;163:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">max0</span><span class="p">,</span> <span class="nf">min0</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+164:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">areaPixel</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_areaPixel = 0.0;
  __pyx_v_delta = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+165:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">A0</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">B0</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">C0</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">D0</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">A1</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">B1</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">C1</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">D1</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_A0 = 0.0;
  __pyx_v_B0 = 0.0;
  __pyx_v_C0 = 0.0;
  __pyx_v_D0 = 0.0;
  __pyx_v_A1 = 0.0;
  __pyx_v_B1 = 0.0;
  __pyx_v_C1 = 0.0;
  __pyx_v_D1 = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+166:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">A_lim</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">B_lim</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">C_lim</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">D_lim</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_A_lim = 0.0;
  __pyx_v_B_lim = 0.0;
  __pyx_v_C_lim = 0.0;
  __pyx_v_D_lim = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+167:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">oneOverArea</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">partialArea</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">tmp</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_oneOverArea = 0.0;
  __pyx_v_partialArea = 0.0;
  __pyx_v_tmp = 0.0;
</pre><pre class='cython line score-0'>&#xA0;168:         <span class="k">cdef</span> <span class="kt">Function</span> <span class="nf">AB</span><span class="p">,</span> <span class="nf">BC</span><span class="p">,</span> <span class="nf">CD</span><span class="p">,</span> <span class="nf">DA</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+169:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">bins</span><span class="p">,</span> <span class="nf">i</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">bin0_max</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">bin0_min</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">pixel_bins</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_i = 0;
  __pyx_v_idx = 0;
  __pyx_v_bin = 0;
  __pyx_v_bin0_max = 0;
  __pyx_v_bin0_min = 0;
  __pyx_v_pixel_bins = 0;
  __pyx_v_k = 0;
  __pyx_v_size = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+170:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">check_pos1</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">check_mask</span><span class="o">=</span><span class="bp">False</span></pre>
<pre class='cython code score-0'>  __pyx_v_check_pos1 = 0;
  __pyx_v_check_mask = 0;
</pre><pre class='cython line score-0'>&#xA0;171: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+172:         <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bins = __pyx_t_9;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+173:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0Range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos0Range</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0Range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_11 = (__pyx_t_2 != Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_12 = (__pyx_t_11 != 0);
  if (__pyx_t_12) {
  } else {
    __pyx_t_10 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0Range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_13 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_12 = ((__pyx_t_13 &gt; 1) != 0);
  __pyx_t_10 = __pyx_t_12;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_10) {
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+174:             <span class="bp">self</span><span class="o">.</span><span class="n">pos0_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos0Range</span><span class="p">)</span></pre>
<pre class='cython code score-14'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0Range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_min, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_min, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+175:             <span class="bp">self</span><span class="o">.</span><span class="n">pos0_maxin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos0Range</span><span class="p">)</span></pre>
<pre class='cython code score-14'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0Range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_max, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_maxin, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;176:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+177:             <span class="bp">self</span><span class="o">.</span><span class="n">pos0_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span></pre>
<pre class='cython code score-45'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_slice__3 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__3);
  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__5);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_min, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__3, __pyx_slice__4, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+178:             <span class="bp">self</span><span class="o">.</span><span class="n">pos0_maxin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span></pre>
<pre class='cython code score-45'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__8);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_maxin, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_L3:;
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__6, __pyx_slice__7, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+179:         <span class="bp">self</span><span class="o">.</span><span class="n">pos0_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0_maxin</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span></pre>
<pre class='cython code score-55'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_maxin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_eps);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_int_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_max, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+180:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos1Range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos1Range</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1Range);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_12 = (__pyx_t_5 != Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = (__pyx_t_12 != 0);
  if (__pyx_t_11) {
  } else {
    __pyx_t_10 = __pyx_t_11;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1Range);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_13 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = ((__pyx_t_13 &gt; 1) != 0);
  __pyx_t_10 = __pyx_t_11;
  __pyx_L7_bool_binop_done:;
  if (__pyx_t_10) {
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+181:             <span class="bp">self</span><span class="o">.</span><span class="n">pos1_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos1Range</span><span class="p">)</span></pre>
<pre class='cython code score-14'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1Range);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_min, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_min, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+182:             <span class="bp">self</span><span class="o">.</span><span class="n">pos1_maxin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos1Range</span><span class="p">)</span></pre>
<pre class='cython code score-14'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1Range);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_max, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_maxin, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+183:             <span class="bp">self</span><span class="o">.</span><span class="n">check_pos1</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_check_pos1, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L6;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;184:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+185:             <span class="bp">self</span><span class="o">.</span><span class="n">pos1_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span></pre>
<pre class='cython code score-45'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
  __pyx_slice__10 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__11);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_2) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_min, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__9, __pyx_slice__10, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+186:             <span class="bp">self</span><span class="o">.</span><span class="n">pos1_maxin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span></pre>
<pre class='cython code score-45'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_slice__12 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__12);
  __pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__14);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_2) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_maxin, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_L6:;
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__12, __pyx_slice__13, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+187:         <span class="bp">self</span><span class="o">.</span><span class="n">pos1_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos1_maxin</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span></pre>
<pre class='cython code score-55'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_maxin);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_eps);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_int_1, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_max, __pyx_t_14) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='cython line score-0'>&#xA0;188: </pre>
<pre class='cython line score-23' onclick='toggleDiv(this)'>+189:         <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos0_max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">bins</span><span class="p">))</span></pre>
<pre class='cython code score-23'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_max);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)__pyx_v_bins));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_delta, __pyx_t_14) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='cython line score-0'>&#xA0;190: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+191:         <span class="n">pos0_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0_min</span></pre>
<pre class='cython code score-8'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_min);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_15 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_pos0_min = __pyx_t_15;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+192:         <span class="n">pos0_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos0_max</span></pre>
<pre class='cython code score-8'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos0_max);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_15 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_pos0_max = __pyx_t_15;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+193:         <span class="n">pos1_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos1_min</span></pre>
<pre class='cython code score-8'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_min);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_15 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_pos1_min = __pyx_t_15;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+194:         <span class="n">pos1_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos1_max</span></pre>
<pre class='cython code score-8'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_pos1_max);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_15 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_pos1_max = __pyx_t_15;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+195:         <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span></pre>
<pre class='cython code score-8'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_delta);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_15 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_delta = __pyx_t_15;
</pre><pre class='cython line score-0'>&#xA0;196: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+197:         <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-5'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_size = __pyx_t_9;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+198:         <span class="n">check_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_mask</span></pre>
<pre class='cython code score-5'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_check_mask);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_14);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_check_mask = __pyx_t_10;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+199:         <span class="k">if</span> <span class="n">check_mask</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_10 = (__pyx_v_check_mask != 0);
  if (__pyx_t_10) {
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+200:             <span class="n">cmask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmask</span></pre>
<pre class='cython code score-3'>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_cmask);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_int8_t(__pyx_t_14);
    if (unlikely(!__pyx_t_16.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_v_cmask = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    goto __pyx_L9;
  }
  __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;201: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+202:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L12;
        }
        __pyx_L11_error: {
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L12:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+203:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_9 = __pyx_v_size;
        for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_9; __pyx_t_17+=1) {
          __pyx_v_idx = __pyx_t_17;
</pre><pre class='cython line score-0'>&#xA0;204: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+205:                 <span class="k">if</span> <span class="p">(</span><span class="n">check_mask</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cmask</span><span class="p">[</span><span class="n">idx</span><span class="p">]):</span></pre>
<pre class='cython code score-2'>          __pyx_t_11 = (__pyx_v_check_mask != 0);
          if (__pyx_t_11) {
          } else {
            __pyx_t_10 = __pyx_t_11;
            goto __pyx_L16_bool_binop_done;
          }
          if (unlikely(!__pyx_v_cmask.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cmask"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L11_error;}</span> }
          __pyx_t_18 = __pyx_v_idx;
          __pyx_t_11 = ((*((__pyx_t_5numpy_int8_t *) ( /* dim=0 */ (__pyx_v_cmask.data + __pyx_t_18 * __pyx_v_cmask.strides[0]) ))) != 0);
          __pyx_t_10 = __pyx_t_11;
          __pyx_L16_bool_binop_done:;
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+206:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L13_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;207: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+208:                 <span class="n">A0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_19 = __pyx_v_idx;
          __pyx_t_20 = 0;
          __pyx_t_21 = 0;
          __pyx_v_A0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+209:                 <span class="n">A1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_22 = __pyx_v_idx;
          __pyx_t_23 = 0;
          __pyx_t_24 = 1;
          __pyx_v_A1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_23, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_24, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+210:                 <span class="n">B0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_25 = __pyx_v_idx;
          __pyx_t_26 = 1;
          __pyx_t_27 = 0;
          __pyx_v_B0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_27, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+211:                 <span class="n">B1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_28 = __pyx_v_idx;
          __pyx_t_29 = 1;
          __pyx_t_30 = 1;
          __pyx_v_B1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_30, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+212:                 <span class="n">C0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_31 = __pyx_v_idx;
          __pyx_t_32 = 2;
          __pyx_t_33 = 0;
          __pyx_v_C0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_33, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+213:                 <span class="n">C1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_34 = __pyx_v_idx;
          __pyx_t_35 = 2;
          __pyx_t_36 = 1;
          __pyx_v_C1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_36, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+214:                 <span class="n">D0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_37 = __pyx_v_idx;
          __pyx_t_38 = 3;
          __pyx_t_39 = 0;
          __pyx_v_D0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_39, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+215:                 <span class="n">D1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_40 = __pyx_v_idx;
          __pyx_t_41 = 3;
          __pyx_t_42 = 1;
          __pyx_v_D1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0'>&#xA0;216: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+217:                 <span class="n">min0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_B0;
          __pyx_t_43 = __pyx_v_C0;
          __pyx_t_44 = __pyx_v_D0;
          __pyx_t_45 = __pyx_v_A0;
          if (((__pyx_t_15 &lt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_15;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_t_45 = __pyx_t_46;
          if (((__pyx_t_43 &lt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_43;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_t_45 = __pyx_t_46;
          if (((__pyx_t_44 &lt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_44;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_v_min0 = __pyx_t_46;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+218:                 <span class="n">max0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_46 = __pyx_v_B0;
          __pyx_t_15 = __pyx_v_C0;
          __pyx_t_43 = __pyx_v_D0;
          __pyx_t_44 = __pyx_v_A0;
          if (((__pyx_t_46 &gt; __pyx_t_44) != 0)) {
            __pyx_t_45 = __pyx_t_46;
          } else {
            __pyx_t_45 = __pyx_t_44;
          }
          __pyx_t_44 = __pyx_t_45;
          if (((__pyx_t_15 &gt; __pyx_t_44) != 0)) {
            __pyx_t_45 = __pyx_t_15;
          } else {
            __pyx_t_45 = __pyx_t_44;
          }
          __pyx_t_44 = __pyx_t_45;
          if (((__pyx_t_43 &gt; __pyx_t_44) != 0)) {
            __pyx_t_45 = __pyx_t_43;
          } else {
            __pyx_t_45 = __pyx_t_44;
          }
          __pyx_v_max0 = __pyx_t_45;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+219:                 <span class="k">if</span> <span class="p">(</span><span class="n">max0</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">min0</span> <span class="o">&gt;=</span><span class="n">bins</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_11 = ((__pyx_v_max0 &lt; 0.0) != 0);
          if (!__pyx_t_11) {
          } else {
            __pyx_t_10 = __pyx_t_11;
            goto __pyx_L19_bool_binop_done;
          }
          __pyx_t_11 = ((__pyx_v_min0 &gt;= __pyx_v_bins) != 0);
          __pyx_t_10 = __pyx_t_11;
          __pyx_L19_bool_binop_done:;
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+220:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L13_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+221:                 <span class="k">if</span> <span class="n">check_pos1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_10 = (__pyx_v_check_pos1 != 0);
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+222:                     <span class="k">if</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pos1_min</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pos1_maxin</span><span class="p">):</span></pre>
<pre class='cython code score-0'>            __pyx_t_45 = __pyx_v_B1;
            __pyx_t_46 = __pyx_v_C1;
            __pyx_t_15 = __pyx_v_D1;
            __pyx_t_43 = __pyx_v_A1;
            if (((__pyx_t_45 &gt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_45;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_43 = __pyx_t_44;
            if (((__pyx_t_46 &gt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_46;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_43 = __pyx_t_44;
            if (((__pyx_t_15 &gt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_15;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_11 = ((__pyx_t_44 &lt; __pyx_v_pos1_min) != 0);
            if (!__pyx_t_11) {
            } else {
              __pyx_t_10 = __pyx_t_11;
              goto __pyx_L23_bool_binop_done;
            }
            __pyx_t_44 = __pyx_v_B1;
            __pyx_t_45 = __pyx_v_C1;
            __pyx_t_46 = __pyx_v_D1;
            __pyx_t_15 = __pyx_v_A1;
            if (((__pyx_t_44 &lt; __pyx_t_15) != 0)) {
              __pyx_t_43 = __pyx_t_44;
            } else {
              __pyx_t_43 = __pyx_t_15;
            }
            __pyx_t_15 = __pyx_t_43;
            if (((__pyx_t_45 &lt; __pyx_t_15) != 0)) {
              __pyx_t_43 = __pyx_t_45;
            } else {
              __pyx_t_43 = __pyx_t_15;
            }
            __pyx_t_15 = __pyx_t_43;
            if (((__pyx_t_46 &lt; __pyx_t_15) != 0)) {
              __pyx_t_43 = __pyx_t_46;
            } else {
              __pyx_t_43 = __pyx_t_15;
            }
            __pyx_t_11 = ((__pyx_t_43 &gt; __pyx_v_pos1_maxin) != 0);
            __pyx_t_10 = __pyx_t_11;
            __pyx_L23_bool_binop_done:;
            if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+223:                         <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L13_continue;
            }
            goto __pyx_L21;
          }
          __pyx_L21:;
</pre><pre class='cython line score-0'>&#xA0;224: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+225:                 <span class="n">bin0_min</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="nb">int</span> <span class="o">&gt;</span> <span class="n">floor</span><span class="p">(</span><span class="n">min0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_v_bin0_min = ((int)floor(__pyx_v_min0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+226:                 <span class="n">bin0_max</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="nb">int</span> <span class="o">&gt;</span> <span class="n">floor</span><span class="p">(</span><span class="n">max0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_v_bin0_max = ((int)floor(__pyx_v_max0));
</pre><pre class='cython line score-0'>&#xA0;227: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+228:                 <span class="k">for</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin0_min</span><span class="p">,</span> <span class="n">bin0_max</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_47 = (__pyx_v_bin0_max + 1);
          for (__pyx_t_48 = __pyx_v_bin0_min; __pyx_t_48 &lt; __pyx_t_47; __pyx_t_48+=1) {
            __pyx_v_bin = __pyx_t_48;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+229:                     <span class="n">outMax</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>            __pyx_t_49 = __pyx_v_bin;
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_outMax.diminfo[0].strides) += 1;
          }
          __pyx_L13_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;230: </pre>
<pre class='cython line score-26' onclick='toggleDiv(this)'>+231:         <span class="n">indptr</span><span class="p">[</span><span class="mf">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">outMax</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span></pre>
<pre class='cython code score-26'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_outMax), __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(((PyObject *)__pyx_v_indptr), __pyx_t_14, 1, 0, NULL, NULL, &amp;__pyx_slice__15, 1, 0, 0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
  __pyx_slice__15 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__15);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+232:         <span class="bp">self</span><span class="o">.</span><span class="n">indptr</span> <span class="o">=</span> <span class="n">indptr</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_indptr, ((PyObject *)__pyx_v_indptr)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;233: </pre>
<pre class='cython line score-37' onclick='toggleDiv(this)'>+234:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">int32_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="n">bins</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-37'>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_9 = __pyx_v_bins;
  __pyx_t_14 = __Pyx_PyInt_From_npy_int32((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_indptr.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_50 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_50, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indices = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_indices.diminfo[0].strides = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indices.diminfo[0].shape = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_50 = 0;
  __pyx_v_indices = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-37' onclick='toggleDiv(this)'>+235:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="n">bins</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-37'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_17 = __pyx_v_bins;
  __pyx_t_1 = __Pyx_PyInt_From_npy_int32((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_indptr.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_51 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_51, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_data = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_data.diminfo[0].strides = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_data.diminfo[0].shape = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_51 = 0;
  __pyx_v_data = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-37' onclick='toggleDiv(this)'>+236:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float32_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">areas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="n">bins</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-37'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_48 = __pyx_v_bins;
  __pyx_t_4 = __Pyx_PyInt_From_npy_int32((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_indptr.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_52 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_52, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_areas = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_areas.diminfo[0].strides = __pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_areas.diminfo[0].shape = __pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_52 = 0;
  __pyx_v_areas = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;237: </pre>
<pre class='cython line score-0'>&#xA0;238:         <span class="c">#just recycle the outMax array</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+239:         <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">outMax</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">0</span><span class="p">,</span> <span class="n">bins</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  __pyx_t_47 = 0;
  memset((&amp;(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_outMax.diminfo[0].strides))), 0, (__pyx_v_bins * (sizeof(__pyx_t_5numpy_int32_t))));
</pre><pre class='cython line score-0'>&#xA0;240: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+241:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L29;
        }
        __pyx_L28_error: {
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L29:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+242:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_53 = __pyx_v_size;
        for (__pyx_t_54 = 0; __pyx_t_54 &lt; __pyx_t_53; __pyx_t_54+=1) {
          __pyx_v_idx = __pyx_t_54;
</pre><pre class='cython line score-0'>&#xA0;243: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+244:                 <span class="k">if</span> <span class="p">(</span><span class="n">check_mask</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cmask</span><span class="p">[</span><span class="n">idx</span><span class="p">]):</span></pre>
<pre class='cython code score-2'>          __pyx_t_11 = (__pyx_v_check_mask != 0);
          if (__pyx_t_11) {
          } else {
            __pyx_t_10 = __pyx_t_11;
            goto __pyx_L33_bool_binop_done;
          }
          if (unlikely(!__pyx_v_cmask.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cmask"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L28_error;}</span> }
          __pyx_t_55 = __pyx_v_idx;
          __pyx_t_11 = ((*((__pyx_t_5numpy_int8_t *) ( /* dim=0 */ (__pyx_v_cmask.data + __pyx_t_55 * __pyx_v_cmask.strides[0]) ))) != 0);
          __pyx_t_10 = __pyx_t_11;
          __pyx_L33_bool_binop_done:;
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+245:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L30_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;246: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+247:                 <span class="n">A0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_56 = __pyx_v_idx;
          __pyx_t_57 = 0;
          __pyx_t_58 = 0;
          __pyx_v_A0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_57, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_58, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+248:                 <span class="n">A1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_59 = __pyx_v_idx;
          __pyx_t_60 = 0;
          __pyx_t_61 = 1;
          __pyx_v_A1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_60, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_61, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+249:                 <span class="n">B0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_62 = __pyx_v_idx;
          __pyx_t_63 = 1;
          __pyx_t_64 = 0;
          __pyx_v_B0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_63, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_64, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+250:                 <span class="n">B1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_65 = __pyx_v_idx;
          __pyx_t_66 = 1;
          __pyx_t_67 = 1;
          __pyx_v_B1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+251:                 <span class="n">C0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_68 = __pyx_v_idx;
          __pyx_t_69 = 2;
          __pyx_t_70 = 0;
          __pyx_v_C0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_69, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_70, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+252:                 <span class="n">C1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_71 = __pyx_v_idx;
          __pyx_t_72 = 2;
          __pyx_t_73 = 1;
          __pyx_v_C1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+253:                 <span class="n">D0</span> <span class="o">=</span> <span class="n">getBinNr</span><span class="p">(</span><span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">pos0_min</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_74 = __pyx_v_idx;
          __pyx_t_75 = 3;
          __pyx_t_76 = 0;
          __pyx_v_D0 = __pyx_f_19splitPixelFullLUT_b_getBinNr(((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_75, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_76, __pyx_pybuffernd_cpos.diminfo[2].strides))), __pyx_v_pos0_min, __pyx_v_delta);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+254:                 <span class="n">D1</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="n">double</span> <span class="o">&gt;</span> <span class="n">cpos</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_t_77 = __pyx_v_idx;
          __pyx_t_78 = 3;
          __pyx_t_79 = 1;
          __pyx_v_D1 = ((double)(*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_cpos.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_cpos.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_cpos.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_cpos.diminfo[2].strides)));
</pre><pre class='cython line score-0'>&#xA0;255: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+256:                 <span class="n">min0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_43 = __pyx_v_B0;
          __pyx_t_44 = __pyx_v_C0;
          __pyx_t_45 = __pyx_v_D0;
          __pyx_t_46 = __pyx_v_A0;
          if (((__pyx_t_43 &lt; __pyx_t_46) != 0)) {
            __pyx_t_15 = __pyx_t_43;
          } else {
            __pyx_t_15 = __pyx_t_46;
          }
          __pyx_t_46 = __pyx_t_15;
          if (((__pyx_t_44 &lt; __pyx_t_46) != 0)) {
            __pyx_t_15 = __pyx_t_44;
          } else {
            __pyx_t_15 = __pyx_t_46;
          }
          __pyx_t_46 = __pyx_t_15;
          if (((__pyx_t_45 &lt; __pyx_t_46) != 0)) {
            __pyx_t_15 = __pyx_t_45;
          } else {
            __pyx_t_15 = __pyx_t_46;
          }
          __pyx_v_min0 = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+257:                 <span class="n">max0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_B0;
          __pyx_t_43 = __pyx_v_C0;
          __pyx_t_44 = __pyx_v_D0;
          __pyx_t_45 = __pyx_v_A0;
          if (((__pyx_t_15 &gt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_15;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_t_45 = __pyx_t_46;
          if (((__pyx_t_43 &gt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_43;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_t_45 = __pyx_t_46;
          if (((__pyx_t_44 &gt; __pyx_t_45) != 0)) {
            __pyx_t_46 = __pyx_t_44;
          } else {
            __pyx_t_46 = __pyx_t_45;
          }
          __pyx_v_max0 = __pyx_t_46;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+258:                 <span class="k">if</span> <span class="p">(</span><span class="n">max0</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">min0</span> <span class="o">&gt;=</span><span class="n">bins</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_11 = ((__pyx_v_max0 &lt; 0.0) != 0);
          if (!__pyx_t_11) {
          } else {
            __pyx_t_10 = __pyx_t_11;
            goto __pyx_L36_bool_binop_done;
          }
          __pyx_t_11 = ((__pyx_v_min0 &gt;= __pyx_v_bins) != 0);
          __pyx_t_10 = __pyx_t_11;
          __pyx_L36_bool_binop_done:;
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+259:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L30_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+260:                 <span class="k">if</span> <span class="n">check_pos1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_10 = (__pyx_v_check_pos1 != 0);
          if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+261:                     <span class="k">if</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pos1_min</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pos1_maxin</span><span class="p">):</span></pre>
<pre class='cython code score-0'>            __pyx_t_46 = __pyx_v_B1;
            __pyx_t_15 = __pyx_v_C1;
            __pyx_t_43 = __pyx_v_D1;
            __pyx_t_44 = __pyx_v_A1;
            if (((__pyx_t_46 &gt; __pyx_t_44) != 0)) {
              __pyx_t_45 = __pyx_t_46;
            } else {
              __pyx_t_45 = __pyx_t_44;
            }
            __pyx_t_44 = __pyx_t_45;
            if (((__pyx_t_15 &gt; __pyx_t_44) != 0)) {
              __pyx_t_45 = __pyx_t_15;
            } else {
              __pyx_t_45 = __pyx_t_44;
            }
            __pyx_t_44 = __pyx_t_45;
            if (((__pyx_t_43 &gt; __pyx_t_44) != 0)) {
              __pyx_t_45 = __pyx_t_43;
            } else {
              __pyx_t_45 = __pyx_t_44;
            }
            __pyx_t_11 = ((__pyx_t_45 &lt; __pyx_v_pos1_min) != 0);
            if (!__pyx_t_11) {
            } else {
              __pyx_t_10 = __pyx_t_11;
              goto __pyx_L40_bool_binop_done;
            }
            __pyx_t_45 = __pyx_v_B1;
            __pyx_t_46 = __pyx_v_C1;
            __pyx_t_15 = __pyx_v_D1;
            __pyx_t_43 = __pyx_v_A1;
            if (((__pyx_t_45 &lt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_45;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_43 = __pyx_t_44;
            if (((__pyx_t_46 &lt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_46;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_43 = __pyx_t_44;
            if (((__pyx_t_15 &lt; __pyx_t_43) != 0)) {
              __pyx_t_44 = __pyx_t_15;
            } else {
              __pyx_t_44 = __pyx_t_43;
            }
            __pyx_t_11 = ((__pyx_t_44 &gt; __pyx_v_pos1_maxin) != 0);
            __pyx_t_10 = __pyx_t_11;
            __pyx_L40_bool_binop_done:;
            if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+262:                         <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L30_continue;
            }
            goto __pyx_L38;
          }
          __pyx_L38:;
</pre><pre class='cython line score-0'>&#xA0;263: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+264:                 <span class="n">bin0_min</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="nb">int</span> <span class="o">&gt;</span> <span class="n">floor</span><span class="p">(</span><span class="n">min0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_v_bin0_min = ((int)floor(__pyx_v_min0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+265:                 <span class="n">bin0_max</span> <span class="o">=</span> <span class="o">&lt;</span> <span class="nb">int</span> <span class="o">&gt;</span> <span class="n">floor</span><span class="p">(</span><span class="n">max0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_v_bin0_max = ((int)floor(__pyx_v_max0));
</pre><pre class='cython line score-0'>&#xA0;266: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+267:                 <span class="k">if</span> <span class="n">bin0_min</span> <span class="o">==</span> <span class="n">bin0_max</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_10 = ((__pyx_v_bin0_min == __pyx_v_bin0_max) != 0);
          if (__pyx_t_10) {
</pre><pre class='cython line score-0'>&#xA0;268:                     <span class="c">#All pixel is within a single bin</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+269:                     <span class="n">k</span> <span class="o">=</span> <span class="n">outMax</span><span class="p">[</span><span class="n">bin0_min</span><span class="p">]</span></pre>
<pre class='cython code score-0'>            __pyx_t_80 = __pyx_v_bin0_min;
            __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_outMax.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+270:                     <span class="n">indices</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="n">bin0_min</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0'>            __pyx_t_81 = __pyx_v_bin0_min;
            __pyx_t_82 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_82, __pyx_pybuffernd_indices.diminfo[0].strides) = __pyx_v_idx;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+271:                     <span class="n">data</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="n">bin0_min</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-0'>            __pyx_t_83 = __pyx_v_bin0_min;
            __pyx_t_84 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_data.diminfo[0].strides) = 1.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+272:                     <span class="n">areas</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="n">bin0_min</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-0'>            __pyx_t_85 = __pyx_v_bin0_min;
            __pyx_t_86 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_areas.diminfo[0].strides) = -1.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+273:                     <span class="n">outMax</span><span class="p">[</span><span class="n">bin0_min</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span> <span class="c">#k+1</span></pre>
<pre class='cython code score-0'>            __pyx_t_87 = __pyx_v_bin0_min;
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_outMax.diminfo[0].strides) += 1;
            goto __pyx_L42;
          }
          /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;274:                 <span class="k">else</span><span class="p">:</span>  <span class="c">#else we have pixel spliting.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+275:                     <span class="n">AB</span><span class="o">.</span><span class="n">slope</span><span class="o">=</span><span class="p">(</span><span class="n">B1</span><span class="o">-</span><span class="n">A1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">B0</span><span class="o">-</span><span class="n">A0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_AB.slope = ((__pyx_v_B1 - __pyx_v_A1) / (__pyx_v_B0 - __pyx_v_A0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+276:                     <span class="n">AB</span><span class="o">.</span><span class="n">intersect</span><span class="o">=</span> <span class="n">A1</span> <span class="o">-</span> <span class="n">AB</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">A0</span></pre>
<pre class='cython code score-0'>            __pyx_v_AB.intersect = (__pyx_v_A1 - (__pyx_v_AB.slope * __pyx_v_A0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+277:                     <span class="n">BC</span><span class="o">.</span><span class="n">slope</span><span class="o">=</span><span class="p">(</span><span class="n">C1</span><span class="o">-</span><span class="n">B1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">C0</span><span class="o">-</span><span class="n">B0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_BC.slope = ((__pyx_v_C1 - __pyx_v_B1) / (__pyx_v_C0 - __pyx_v_B0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+278:                     <span class="n">BC</span><span class="o">.</span><span class="n">intersect</span><span class="o">=</span> <span class="n">B1</span> <span class="o">-</span> <span class="n">BC</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">B0</span></pre>
<pre class='cython code score-0'>            __pyx_v_BC.intersect = (__pyx_v_B1 - (__pyx_v_BC.slope * __pyx_v_B0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+279:                     <span class="n">CD</span><span class="o">.</span><span class="n">slope</span><span class="o">=</span><span class="p">(</span><span class="n">D1</span><span class="o">-</span><span class="n">C1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">D0</span><span class="o">-</span><span class="n">C0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_CD.slope = ((__pyx_v_D1 - __pyx_v_C1) / (__pyx_v_D0 - __pyx_v_C0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+280:                     <span class="n">CD</span><span class="o">.</span><span class="n">intersect</span><span class="o">=</span> <span class="n">C1</span> <span class="o">-</span> <span class="n">CD</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">C0</span></pre>
<pre class='cython code score-0'>            __pyx_v_CD.intersect = (__pyx_v_C1 - (__pyx_v_CD.slope * __pyx_v_C0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+281:                     <span class="n">DA</span><span class="o">.</span><span class="n">slope</span><span class="o">=</span><span class="p">(</span><span class="n">A1</span><span class="o">-</span><span class="n">D1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">A0</span><span class="o">-</span><span class="n">D0</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_DA.slope = ((__pyx_v_A1 - __pyx_v_D1) / (__pyx_v_A0 - __pyx_v_D0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+282:                     <span class="n">DA</span><span class="o">.</span><span class="n">intersect</span><span class="o">=</span> <span class="n">D1</span> <span class="o">-</span> <span class="n">DA</span><span class="o">.</span><span class="n">slope</span><span class="o">*</span><span class="n">D0</span></pre>
<pre class='cython code score-0'>            __pyx_v_DA.intersect = (__pyx_v_D1 - (__pyx_v_DA.slope * __pyx_v_D0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+283:                     <span class="n">areaPixel</span> <span class="o">=</span> <span class="n">area4</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_areaPixel = __pyx_f_19splitPixelFullLUT_b_area4(__pyx_v_A0, __pyx_v_A1, __pyx_v_B0, __pyx_v_B1, __pyx_v_C0, __pyx_v_C1, __pyx_v_D0, __pyx_v_D1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+284:                     <span class="n">oneOverPixelArea</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">areaPixel</span></pre>
<pre class='cython code score-0'>            __pyx_v_oneOverPixelArea = (1.0 / __pyx_v_areaPixel);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+285:                     <span class="n">partialArea2</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0'>            __pyx_v_partialArea2 = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+286:                     <span class="k">for</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin0_min</span><span class="p">,</span> <span class="n">bin0_max</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>            __pyx_t_88 = (__pyx_v_bin0_max + 1);
            for (__pyx_t_89 = __pyx_v_bin0_min; __pyx_t_89 &lt; __pyx_t_88; __pyx_t_89+=1) {
              __pyx_v_bin = __pyx_t_89;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+287:                         <span class="n">A_lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">A0</span><span class="o">&lt;=</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="nb">bin</span> <span class="o">+</span> <span class="p">(</span><span class="n">A0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="n">A0</span> <span class="o">+</span> <span class="p">(</span><span class="n">A0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A0</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_A_lim = (((((__pyx_v_A0 &lt;= __pyx_v_bin) * (__pyx_v_A0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_bin) + (((__pyx_v_A0 &gt; __pyx_v_bin) * (__pyx_v_A0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_A0)) + (((__pyx_v_A0 &gt; __pyx_v_bin) * (__pyx_v_A0 &gt; (__pyx_v_bin + 1))) * (__pyx_v_bin + 1)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+288:                         <span class="n">B_lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">B0</span><span class="o">&lt;=</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="nb">bin</span> <span class="o">+</span> <span class="p">(</span><span class="n">B0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="n">B0</span> <span class="o">+</span> <span class="p">(</span><span class="n">B0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B0</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_B_lim = (((((__pyx_v_B0 &lt;= __pyx_v_bin) * (__pyx_v_B0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_bin) + (((__pyx_v_B0 &gt; __pyx_v_bin) * (__pyx_v_B0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_B0)) + (((__pyx_v_B0 &gt; __pyx_v_bin) * (__pyx_v_B0 &gt; (__pyx_v_bin + 1))) * (__pyx_v_bin + 1)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+289:                         <span class="n">C_lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">C0</span><span class="o">&lt;=</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="nb">bin</span> <span class="o">+</span> <span class="p">(</span><span class="n">C0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="n">C0</span> <span class="o">+</span> <span class="p">(</span><span class="n">C0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C0</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_C_lim = (((((__pyx_v_C0 &lt;= __pyx_v_bin) * (__pyx_v_C0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_bin) + (((__pyx_v_C0 &gt; __pyx_v_bin) * (__pyx_v_C0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_C0)) + (((__pyx_v_C0 &gt; __pyx_v_bin) * (__pyx_v_C0 &gt; (__pyx_v_bin + 1))) * (__pyx_v_bin + 1)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+290:                         <span class="n">D_lim</span> <span class="o">=</span> <span class="p">(</span><span class="n">D0</span><span class="o">&lt;=</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">D0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="nb">bin</span> <span class="o">+</span> <span class="p">(</span><span class="n">D0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">D0</span><span class="o">&lt;=</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="n">D0</span> <span class="o">+</span> <span class="p">(</span><span class="n">D0</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">D0</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">bin</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_D_lim = (((((__pyx_v_D0 &lt;= __pyx_v_bin) * (__pyx_v_D0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_bin) + (((__pyx_v_D0 &gt; __pyx_v_bin) * (__pyx_v_D0 &lt;= (__pyx_v_bin + 1))) * __pyx_v_D0)) + (((__pyx_v_D0 &gt; __pyx_v_bin) * (__pyx_v_D0 &gt; (__pyx_v_bin + 1))) * (__pyx_v_bin + 1)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+291:                         <span class="n">partialArea</span>  <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">A_lim</span><span class="p">,</span> <span class="n">B_lim</span><span class="p">,</span> <span class="n">AB</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_partialArea = __pyx_f_19splitPixelFullLUT_b_integrate(__pyx_v_A_lim, __pyx_v_B_lim, __pyx_v_AB);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+292:                         <span class="n">partialArea</span> <span class="o">+=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">B_lim</span><span class="p">,</span> <span class="n">C_lim</span><span class="p">,</span> <span class="n">BC</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_partialArea = (__pyx_v_partialArea + __pyx_f_19splitPixelFullLUT_b_integrate(__pyx_v_B_lim, __pyx_v_C_lim, __pyx_v_BC));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+293:                         <span class="n">partialArea</span> <span class="o">+=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">C_lim</span><span class="p">,</span> <span class="n">D_lim</span><span class="p">,</span> <span class="n">CD</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_partialArea = (__pyx_v_partialArea + __pyx_f_19splitPixelFullLUT_b_integrate(__pyx_v_C_lim, __pyx_v_D_lim, __pyx_v_CD));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+294:                         <span class="n">partialArea</span> <span class="o">+=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">D_lim</span><span class="p">,</span> <span class="n">A_lim</span><span class="p">,</span> <span class="n">DA</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_partialArea = (__pyx_v_partialArea + __pyx_f_19splitPixelFullLUT_b_integrate(__pyx_v_D_lim, __pyx_v_A_lim, __pyx_v_DA));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+295:                         <span class="n">tmp</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">partialArea</span><span class="p">)</span> <span class="o">*</span> <span class="n">oneOverPixelArea</span></pre>
<pre class='cython code score-0'>              __pyx_v_tmp = (fabs(__pyx_v_partialArea) * __pyx_v_oneOverPixelArea);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+296:                         <span class="n">k</span> <span class="o">=</span> <span class="n">outMax</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span></pre>
<pre class='cython code score-0'>              __pyx_t_90 = __pyx_v_bin;
              __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_90, __pyx_pybuffernd_outMax.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+297:                         <span class="n">indices</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0'>              __pyx_t_91 = __pyx_v_bin;
              __pyx_t_92 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_indices.diminfo[0].strides) = __pyx_v_idx;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+298:                         <span class="n">data</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span></pre>
<pre class='cython code score-0'>              __pyx_t_93 = __pyx_v_bin;
              __pyx_t_94 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_data.diminfo[0].strides) = __pyx_v_tmp;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+299:                         <span class="n">areas</span><span class="p">[</span><span class="n">indptr</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">partialArea</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_t_95 = __pyx_v_bin;
              __pyx_t_96 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_indptr.diminfo[0].strides)) + __pyx_v_k);
              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_areas.rcbuffer-&gt;pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_areas.diminfo[0].strides) = fabs(__pyx_v_partialArea);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+300:                         <span class="n">outMax</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span> <span class="c">#k+1</span></pre>
<pre class='cython code score-0'>              __pyx_t_97 = __pyx_v_bin;
              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_outMax.rcbuffer-&gt;pybuffer.buf, __pyx_t_97, __pyx_pybuffernd_outMax.diminfo[0].strides) += 1;
            }
          }
          __pyx_L42:;
          __pyx_L30_continue:;
        }
      }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+301:         <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_data, ((PyObject *)__pyx_v_data)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+302:         <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_indices, ((PyObject *)__pyx_v_indices)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+303:         <span class="bp">self</span><span class="o">.</span><span class="n">outMax</span> <span class="o">=</span> <span class="n">outMax</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_outMax, ((PyObject *)__pyx_v_outMax)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+304:         <span class="bp">self</span><span class="o">.</span><span class="n">areas</span> <span class="o">=</span> <span class="n">areas</span></pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_areas, ((PyObject *)__pyx_v_areas)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;305: </pre>
<pre class='cython line score-0'>&#xA0;306:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;307:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;308:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-120' onclick='toggleDiv(this)'>+309:     <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delta_dummy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dark</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">solidAngle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">polarization</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-120'>/* Python wrapper */
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_5integrate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_4integrate[] = "\n        Actually perform the integration which in this case looks more like a matrix-vector product\n\n        @param weights: input image\n        @type weights: ndarray\n        @param dummy: value for dead pixels (optional)\n        @type dummy: float\n        @param delta_dummy: precision for dead-pixel value in dynamic masking\n        @type delta_dummy: float\n        @param dark: array with the dark-current value to be subtracted (if any)\n        @type dark: ndarray\n        @param flat: array with the dark-current value to be divided by (if any)\n        @type flat: ndarray\n        @param solidAngle: array with the solid angle of each pixel to be divided by (if any)\n        @type solidAngle: ndarray\n        @param polarization: array with the polarization correction values to be divided by (if any)\n        @type polarization: ndarray\n        @return : positions, pattern, weighted_histogram and unweighted_histogram\n        @rtype: 4-tuple of ndarrays\n\n        ";
static PyMethodDef __pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_5integrate = {"integrate", (PyCFunction)__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_5integrate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_4integrate};
static PyObject *__pyx_pw_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_5integrate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_weights = 0;
  PyObject *__pyx_v_dummy = 0;
  PyObject *__pyx_v_delta_dummy = 0;
  PyObject *__pyx_v_dark = 0;
  PyObject *__pyx_v_flat = 0;
  PyObject *__pyx_v_solidAngle = 0;
  PyObject *__pyx_v_polarization = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("integrate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_weights,&amp;__pyx_n_s_dummy,&amp;__pyx_n_s_delta_dummy,&amp;__pyx_n_s_dark,&amp;__pyx_n_s_flat,&amp;__pyx_n_s_solidAngle,&amp;__pyx_n_s_polarization,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[2] = ((PyObject *)((PyObject *)Py_None));
    values[3] = ((PyObject *)((PyObject *)Py_None));
    values[4] = ((PyObject *)((PyObject *)Py_None));
    values[5] = ((PyObject *)((PyObject *)Py_None));
    values[6] = ((PyObject *)((PyObject *)Py_None));
    values[7] = ((PyObject *)((PyObject *)Py_None));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_weights)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("integrate", 0, 2, 8, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dummy);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_delta_dummy);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dark);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_flat);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_solidAngle);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_polarization);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "integrate") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_weights = values[1];
    __pyx_v_dummy = values[2];
    __pyx_v_delta_dummy = values[3];
    __pyx_v_dark = values[4];
    __pyx_v_flat = values[5];
    __pyx_v_solidAngle = values[6];
    __pyx_v_polarization = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("integrate", 0, 2, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b.HistoLUT1dFullSplit.integrate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_4integrate(__pyx_self, __pyx_v_self, __pyx_v_weights, __pyx_v_dummy, __pyx_v_delta_dummy, __pyx_v_dark, __pyx_v_flat, __pyx_v_solidAngle, __pyx_v_polarization);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_4integrate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_weights, PyObject *__pyx_v_dummy, PyObject *__pyx_v_delta_dummy, PyObject *__pyx_v_dark, PyObject *__pyx_v_flat, PyObject *__pyx_v_solidAngle, PyObject *__pyx_v_polarization) {
  __pyx_t_5numpy_int32_t __pyx_v_i;
  __pyx_t_5numpy_int32_t __pyx_v_j;
  __pyx_t_5numpy_int32_t __pyx_v_idx;
  CYTHON_UNUSED __pyx_t_5numpy_int32_t __pyx_v_bins;
  __pyx_t_5numpy_int32_t __pyx_v_size;
  double __pyx_v_sum_data;
  double __pyx_v_sum_count;
  double __pyx_v_epsilon;
  double __pyx_v_data;
  double __pyx_v_coef;
  double __pyx_v_cdummy;
  double __pyx_v_cddummy;
  int __pyx_v_do_dummy;
  int __pyx_v_do_dark;
  int __pyx_v_do_flat;
  int __pyx_v_do_polarization;
  int __pyx_v_do_solidAngle;
  PyArrayObject *__pyx_v_outData = 0;
  PyArrayObject *__pyx_v_outCount = 0;
  PyArrayObject *__pyx_v_outMerge = 0;
  __Pyx_memviewslice __pyx_v_ccoef = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_cdata = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tdata = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_cflat = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_cdark = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_csolidAngle = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_cpolarization = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_indptr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_outCount;
  __Pyx_Buffer __pyx_pybuffer_outCount;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_outData;
  __Pyx_Buffer __pyx_pybuffer_outData;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_outMerge;
  __Pyx_Buffer __pyx_pybuffer_outMerge;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("integrate", 0);
  __pyx_pybuffer_outData.pybuffer.buf = NULL;
  __pyx_pybuffer_outData.refcount = 0;
  __pyx_pybuffernd_outData.data = NULL;
  __pyx_pybuffernd_outData.rcbuffer = &amp;__pyx_pybuffer_outData;
  __pyx_pybuffer_outCount.pybuffer.buf = NULL;
  __pyx_pybuffer_outCount.refcount = 0;
  __pyx_pybuffernd_outCount.data = NULL;
  __pyx_pybuffernd_outCount.rcbuffer = &amp;__pyx_pybuffer_outCount;
  __pyx_pybuffer_outMerge.pybuffer.buf = NULL;
  __pyx_pybuffer_outMerge.refcount = 0;
  __pyx_pybuffernd_outMerge.data = NULL;
  __pyx_pybuffernd_outMerge.rcbuffer = &amp;__pyx_pybuffer_outMerge;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitPixelFullLUT_b.HistoLUT1dFullSplit.integrate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_outData);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_outCount);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_outMerge);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ccoef, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cdata, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tdata, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cflat, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cdark, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_csolidAngle, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cpolarization, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indices, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_indptr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(37, __pyx_n_s_self, __pyx_n_s_weights, __pyx_n_s_dummy, __pyx_n_s_delta_dummy, __pyx_n_s_dark, __pyx_n_s_flat, __pyx_n_s_solidAngle, __pyx_n_s_polarization, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_idx, __pyx_n_s_bins, __pyx_n_s_size, __pyx_n_s_sum_data, __pyx_n_s_sum_count, __pyx_n_s_epsilon, __pyx_n_s_data, __pyx_n_s_coef, __pyx_n_s_cdummy, __pyx_n_s_cddummy, __pyx_n_s_do_dummy, __pyx_n_s_do_dark, __pyx_n_s_do_flat, __pyx_n_s_do_polarization, __pyx_n_s_do_solidAngle, __pyx_n_s_outData, __pyx_n_s_outCount, __pyx_n_s_outMerge, __pyx_n_s_ccoef, __pyx_n_s_cdata, __pyx_n_s_tdata, __pyx_n_s_cflat, __pyx_n_s_cdark, __pyx_n_s_csolidAngle, __pyx_n_s_cpolarization, __pyx_n_s_indices, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 37, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_kieffer_workspace_pyFAI_sr, __pyx_n_s_integrate, 309, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_19splitPixelFullLUT_b_19HistoLUT1dFullSplit_5integrate, 0, __pyx_n_s_HistoLUT1dFullSplit_integrate, NULL, __pyx_n_s_splitPixelFullLUT_b, __pyx_d, ((PyObject *)__pyx_codeobj__38));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_8, __pyx_tuple__39);
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_7, __pyx_n_s_integrate, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(6, ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)Py_None));<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
</pre><pre class='cython line score-0'>&#xA0;310:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;311: <span class="sd">        Actually perform the integration which in this case looks more like a matrix-vector product</span></pre>
<pre class='cython line score-0'>&#xA0;312: </pre>
<pre class='cython line score-0'>&#xA0;313: <span class="sd">        @param weights: input image</span></pre>
<pre class='cython line score-0'>&#xA0;314: <span class="sd">        @type weights: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;315: <span class="sd">        @param dummy: value for dead pixels (optional)</span></pre>
<pre class='cython line score-0'>&#xA0;316: <span class="sd">        @type dummy: float</span></pre>
<pre class='cython line score-0'>&#xA0;317: <span class="sd">        @param delta_dummy: precision for dead-pixel value in dynamic masking</span></pre>
<pre class='cython line score-0'>&#xA0;318: <span class="sd">        @type delta_dummy: float</span></pre>
<pre class='cython line score-0'>&#xA0;319: <span class="sd">        @param dark: array with the dark-current value to be subtracted (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;320: <span class="sd">        @type dark: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;321: <span class="sd">        @param flat: array with the dark-current value to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;322: <span class="sd">        @type flat: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;323: <span class="sd">        @param solidAngle: array with the solid angle of each pixel to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;324: <span class="sd">        @type solidAngle: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;325: <span class="sd">        @param polarization: array with the polarization correction values to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;326: <span class="sd">        @type polarization: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;327: <span class="sd">        @return : positions, pattern, weighted_histogram and unweighted_histogram</span></pre>
<pre class='cython line score-0'>&#xA0;328: <span class="sd">        @rtype: 4-tuple of ndarrays</span></pre>
<pre class='cython line score-0'>&#xA0;329: </pre>
<pre class='cython line score-0'>&#xA0;330: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+331:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int32_t</span> <span class="nf">i</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-6'>  __pyx_v_i = 0;
  __pyx_v_j = 0;
  __pyx_v_idx = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_npy_int32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (npy_int32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bins = __pyx_t_2;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_npy_int32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (npy_int32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+332:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">sum_data</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sum_count</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-10</span></pre>
<pre class='cython code score-0'>  __pyx_v_sum_data = 0.0;
  __pyx_v_sum_count = 0.0;
  __pyx_v_epsilon = 1e-10;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+333:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">data</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">cdummy</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">cddummy</span><span class="o">=</span><span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_data = 0.0;
  __pyx_v_coef = 0.0;
  __pyx_v_cdummy = 0.0;
  __pyx_v_cddummy = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+334:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">do_dummy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_dark</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_flat</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_polarization</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_solidAngle</span><span class="o">=</span><span class="bp">False</span></pre>
<pre class='cython code score-0'>  __pyx_v_do_dummy = 0;
  __pyx_v_do_dark = 0;
  __pyx_v_do_flat = 0;
  __pyx_v_do_polarization = 0;
  __pyx_v_do_solidAngle = 0;
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+335:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">outData</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-39'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_outData = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_outData.diminfo[0].strides = __pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_outData.diminfo[0].shape = __pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_outData = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+336:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">outCount</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-39'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_outCount = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_outCount.diminfo[0].strides = __pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_outCount.diminfo[0].shape = __pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_outCount = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+337:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">1</span><span class="p">]</span> <span class="n">outMerge</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-39'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_bins);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_outMerge = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_outMerge.diminfo[0].strides = __pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_outMerge.diminfo[0].shape = __pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_outMerge = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+338:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">ccoef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cdata</span><span class="p">,</span> <span class="n">tdata</span><span class="p">,</span> <span class="n">cflat</span><span class="p">,</span> <span class="n">cdark</span><span class="p">,</span> <span class="n">csolidAngle</span><span class="p">,</span> <span class="n">cpolarization</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ccoef = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;339: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+340:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int32_t</span>[<span class="p">:]</span> <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">indptr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indptr</span></pre>
<pre class='cython code score-6'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_int32_t(__pyx_t_3);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_indices = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_int32_t(__pyx_t_3);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_indptr = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+341:         <span class="k">assert</span> <span class="n">size</span> <span class="o">==</span> <span class="n">weights</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-17'>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_12)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class='cython line score-0'>&#xA0;342: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+343:         <span class="k">if</span> <span class="n">dummy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_12 = (__pyx_v_dummy != Py_None);
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+344:             <span class="n">do_dummy</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_v_do_dummy = 1;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+345:             <span class="n">cdummy</span> <span class="o">=</span>  <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="nb">float</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span></pre>
<pre class='cython code score-2'>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_v_dummy);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_cdummy = ((double)__pyx_t_14);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+346:             <span class="k">if</span> <span class="n">delta_dummy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_13 = (__pyx_v_delta_dummy == Py_None);
    __pyx_t_12 = (__pyx_t_13 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+347:                 <span class="n">cddummy</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_cddummy = ((double)0.0);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;348:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+349:                 <span class="n">cddummy</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="nb">float</span><span class="p">(</span><span class="n">delta_dummy</span><span class="p">)</span></pre>
<pre class='cython code score-2'>      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_v_delta_dummy);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_cddummy = ((double)__pyx_t_14);
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;350: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+351:         <span class="k">if</span> <span class="n">flat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_12 = (__pyx_v_flat != Py_None);
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+352:             <span class="n">do_flat</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_v_do_flat = 1;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+353:             <span class="k">assert</span> <span class="n">flat</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">size</span></pre>
<pre class='cython code score-17'>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flat, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_13 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_13)) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    #endif
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+354:             <span class="n">cflat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">flat</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flat, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (__pyx_t_6) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_cflat = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+355:         <span class="k">if</span> <span class="n">dark</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = (__pyx_v_dark != Py_None);
  __pyx_t_12 = (__pyx_t_13 != 0);
  if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+356:             <span class="n">do_dark</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_v_do_dark = 1;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+357:             <span class="k">assert</span> <span class="n">dark</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">size</span></pre>
<pre class='cython code score-17'>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dark, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_12)) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    #endif
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+358:             <span class="n">cdark</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">dark</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dark, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_cdark = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+359:         <span class="k">if</span> <span class="n">solidAngle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_12 = (__pyx_v_solidAngle != Py_None);
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+360:             <span class="n">do_solidAngle</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_v_do_solidAngle = 1;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+361:             <span class="k">assert</span> <span class="n">solidAngle</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">size</span></pre>
<pre class='cython code score-17'>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_solidAngle, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_13 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_13)) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    #endif
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+362:             <span class="n">csolidAngle</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">solidAngle</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_solidAngle, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_csolidAngle = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+363:         <span class="k">if</span> <span class="n">polarization</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = (__pyx_v_polarization != Py_None);
  __pyx_t_12 = (__pyx_t_13 != 0);
  if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+364:             <span class="n">do_polarization</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_v_do_polarization = 1;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+365:             <span class="k">assert</span> <span class="n">polarization</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">size</span></pre>
<pre class='cython code score-17'>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_polarization, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_12)) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    #endif
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+366:             <span class="n">cpolarization</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">polarization</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_polarization, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_cpolarization = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;367: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+368:         <span class="k">if</span> <span class="p">(</span><span class="n">do_dark</span> <span class="o">+</span> <span class="n">do_flat</span> <span class="o">+</span> <span class="n">do_polarization</span> <span class="o">+</span> <span class="n">do_solidAngle</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_12 = ((((__pyx_v_do_dark + __pyx_v_do_flat) + __pyx_v_do_polarization) + __pyx_v_do_solidAngle) != 0);
  if (__pyx_t_12) {
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+369:             <span class="n">tdata</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_1) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_tdata = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class='cython line score-35' onclick='toggleDiv(this)'>+370:             <span class="n">cdata</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-35'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_cdata = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+371:             <span class="k">if</span> <span class="n">do_dummy</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = (__pyx_v_do_dummy != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+372:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&quot;static&quot;</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      {
          #ifdef WITH_THREAD
          PyThreadState *_save;
          Py_UNBLOCK_THREADS
          #endif
          /*try:*/ {
            __pyx_t_2 = __pyx_v_size;
            if (1 == 0) abort();
            {
                #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                    #undef likely
                    #undef unlikely
                    #define likely(x)   (x)
                    #define unlikely(x) (x)
                #endif
                __pyx_t_16 = (__pyx_t_2 - 0) / 1;
                if (__pyx_t_16 &gt; 0)
                {
                    #ifdef _OPENMP
                    #pragma omp parallel
                    #endif /* _OPENMP */
                    {
                        #ifdef _OPENMP
                        #pragma omp for lastprivate(__pyx_v_data) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) schedule(static)
                        #endif /* _OPENMP */
                        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_16; __pyx_t_15++){
                            {
                                __pyx_v_i = 0 + 1 * __pyx_t_15;
                                /* Initialize private variables to invalid values */
                                __pyx_v_data = ((double)__PYX_NAN());
/* … */
          /*finally:*/ {
            /*normal exit:*/{
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L13;
            }
            __pyx_L11_return: {
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L0;
            }
            __pyx_L12_error: {
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L1_error;
            }
            __pyx_L13:;
          }
      }
      goto __pyx_L10;
    }
    /*else*/ {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+373:                     <span class="n">data</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                                __pyx_t_17 = __pyx_v_i;
                                __pyx_v_data = (*((double *) ( /* dim=0 */ (__pyx_v_tdata.data + __pyx_t_17 * __pyx_v_tdata.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+374:                     <span class="k">if</span> <span class="p">((</span><span class="n">cddummy</span><span class="o">!=</span><span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">cdummy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">cddummy</span><span class="p">))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">cddummy</span><span class="o">==</span><span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">!=</span><span class="n">cdummy</span><span class="p">)):</span></pre>
<pre class='cython code score-0'>                                __pyx_t_13 = ((__pyx_v_cddummy != 0.0) != 0);
                                if (!__pyx_t_13) {
                                  goto __pyx_L20_next_or;
                                } else {
                                }
                                __pyx_t_13 = ((fabs((__pyx_v_data - __pyx_v_cdummy)) &gt; __pyx_v_cddummy) != 0);
                                if (!__pyx_t_13) {
                                } else {
                                  __pyx_t_12 = __pyx_t_13;
                                  goto __pyx_L19_bool_binop_done;
                                }
                                __pyx_L20_next_or:;
                                __pyx_t_13 = ((__pyx_v_cddummy == 0.0) != 0);
                                if (__pyx_t_13) {
                                } else {
                                  __pyx_t_12 = __pyx_t_13;
                                  goto __pyx_L19_bool_binop_done;
                                }
                                __pyx_t_13 = ((__pyx_v_data != __pyx_v_cdummy) != 0);
                                __pyx_t_12 = __pyx_t_13;
                                __pyx_L19_bool_binop_done:;
                                if (__pyx_t_12) {
</pre><pre class='cython line score-0'>&#xA0;375:                         <span class="c">#Nota: -= and /= operatore are seen as reduction in cython parallel.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+376:                         <span class="k">if</span> <span class="n">do_dark</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_12 = (__pyx_v_do_dark != 0);
                                  if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+377:                             <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">cdark</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                    if (unlikely(!__pyx_v_cdark.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cdark"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L16_error;}</span> }
                                    __pyx_t_18 = __pyx_v_i;
                                    __pyx_v_data = (__pyx_v_data - (*((double *) ( /* dim=0 */ (__pyx_v_cdark.data + __pyx_t_18 * __pyx_v_cdark.strides[0]) ))));
                                    goto __pyx_L23;
                                  }
                                  __pyx_L23:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+378:                         <span class="k">if</span> <span class="n">do_flat</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_12 = (__pyx_v_do_flat != 0);
                                  if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+379:                             <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">cflat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                    if (unlikely(!__pyx_v_cflat.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cflat"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L16_error;}</span> }
                                    __pyx_t_19 = __pyx_v_i;
                                    __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_cflat.data + __pyx_t_19 * __pyx_v_cflat.strides[0]) ))));
                                    goto __pyx_L24;
                                  }
                                  __pyx_L24:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+380:                         <span class="k">if</span> <span class="n">do_polarization</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_12 = (__pyx_v_do_polarization != 0);
                                  if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+381:                             <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">cpolarization</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                    if (unlikely(!__pyx_v_cpolarization.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cpolarization"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L16_error;}</span> }
                                    __pyx_t_20 = __pyx_v_i;
                                    __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_cpolarization.data + __pyx_t_20 * __pyx_v_cpolarization.strides[0]) ))));
                                    goto __pyx_L25;
                                  }
                                  __pyx_L25:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+382:                         <span class="k">if</span> <span class="n">do_solidAngle</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_12 = (__pyx_v_do_solidAngle != 0);
                                  if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+383:                             <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">csolidAngle</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                    if (unlikely(!__pyx_v_csolidAngle.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("csolidAngle"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L16_error;}</span> }
                                    __pyx_t_21 = __pyx_v_i;
                                    __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_csolidAngle.data + __pyx_t_21 * __pyx_v_csolidAngle.strides[0]) ))));
                                    goto __pyx_L26;
                                  }
                                  __pyx_L26:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+384:                         <span class="n">cdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">data</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_22 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_22 * __pyx_v_cdata.strides[0]) )) += __pyx_v_data;
                                  goto __pyx_L18;
                                }
                                /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;385:                     <span class="k">else</span><span class="p">:</span> <span class="c">#set all dummy_like values to cdummy. simplifies further processing</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+386:                         <span class="n">cdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">cdummy</span></pre>
<pre class='cython code score-4'>                                  __pyx_t_23 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_23 * __pyx_v_cdata.strides[0]) )) += __pyx_v_cdummy;
                                }
                                __pyx_L18:;
                                goto __pyx_L28;
                                __pyx_L16_error:;
                                {
                                    #ifdef WITH_THREAD
                                    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                                    #endif
                                    #ifdef _OPENMP
                                    #pragma omp flush(__pyx_parallel_exc_type)
                                    #endif /* _OPENMP */
                                    if (!__pyx_parallel_exc_type) {
                                      <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                      __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                    }
                                    #ifdef WITH_THREAD
                                    PyGILState_Release(__pyx_gilstate_save);
                                    #endif
                                }
                                __pyx_parallel_why = 4;
                                goto __pyx_L27;
                                __pyx_L27:;
                                #ifdef _OPENMP
                                #pragma omp critical(__pyx_parallel_lastprivates24)
                                #endif /* _OPENMP */
                                {
                                    __pyx_parallel_temp0 = __pyx_v_data;
                                    __pyx_parallel_temp1 = __pyx_v_i;
                                }
                                __pyx_L28:;
                                #ifdef _OPENMP
                                #pragma omp flush(__pyx_parallel_why)
                                #endif /* _OPENMP */
                            }
                        }
                        #ifdef _OPENMP
                        Py_END_ALLOW_THREADS
                        #else
{
#ifdef WITH_THREAD
                        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                        #endif
                        #endif /* _OPENMP */
                        /* Clean up any temporaries */
                        #ifdef WITH_THREAD
                        PyGILState_Release(__pyx_gilstate_save);
                        #endif
                        #ifndef _OPENMP
}
#endif /* _OPENMP */
                    }
                }
                if (__pyx_parallel_exc_type) {
                  /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                  __pyx_parallel_why = 4;
                }
                if (__pyx_parallel_why) {
                  __pyx_v_data = __pyx_parallel_temp0;
                  __pyx_v_i = __pyx_parallel_temp1;
                  switch (__pyx_parallel_why) {
                        case 3: goto __pyx_L11_return;
                        case 4:
                    {
                        #ifdef WITH_THREAD
                        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                        #endif
                        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                        <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                        __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                        #ifdef WITH_THREAD
                        PyGILState_Release(__pyx_gilstate_save);
                        #endif
                    }
                    goto __pyx_L12_error;
                  }
                }
            }
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   __builtin_expect(!!(x), 1)
                #define unlikely(x) __builtin_expect(!!(x), 0)
            #endif
          }
</pre><pre class='cython line score-0'>&#xA0;387:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+388:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&quot;static&quot;</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      {
          #ifdef WITH_THREAD
          PyThreadState *_save;
          Py_UNBLOCK_THREADS
          #endif
          /*try:*/ {
            __pyx_t_16 = __pyx_v_size;
            if (1 == 0) abort();
            {
                #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                    #undef likely
                    #undef unlikely
                    #define likely(x)   (x)
                    #define unlikely(x) (x)
                #endif
                __pyx_t_2 = (__pyx_t_16 - 0) / 1;
                if (__pyx_t_2 &gt; 0)
                {
                    #ifdef _OPENMP
                    #pragma omp parallel
                    #endif /* _OPENMP */
                    {
                        #ifdef _OPENMP
                        #pragma omp for lastprivate(__pyx_v_data) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) schedule(static)
                        #endif /* _OPENMP */
                        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_2; __pyx_t_15++){
                            {
                                __pyx_v_i = 0 + 1 * __pyx_t_15;
                                /* Initialize private variables to invalid values */
                                __pyx_v_data = ((double)__PYX_NAN());
/* … */
          /*finally:*/ {
            /*normal exit:*/{
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L31;
            }
            __pyx_L29_return: {
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L0;
            }
            __pyx_L30_error: {
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L1_error;
            }
            __pyx_L31:;
          }
      }
    }
    __pyx_L10:;
    goto __pyx_L9;
  }
  /*else*/ {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+389:                     <span class="n">data</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                                __pyx_t_24 = __pyx_v_i;
                                __pyx_v_data = (*((double *) ( /* dim=0 */ (__pyx_v_tdata.data + __pyx_t_24 * __pyx_v_tdata.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+390:                     <span class="k">if</span> <span class="n">do_dark</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                __pyx_t_12 = (__pyx_v_do_dark != 0);
                                if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+391:                         <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">cdark</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                  if (unlikely(!__pyx_v_cdark.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cdark"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L34_error;}</span> }
                                  __pyx_t_25 = __pyx_v_i;
                                  __pyx_v_data = (__pyx_v_data - (*((double *) ( /* dim=0 */ (__pyx_v_cdark.data + __pyx_t_25 * __pyx_v_cdark.strides[0]) ))));
                                  goto __pyx_L36;
                                }
                                __pyx_L36:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+392:                     <span class="k">if</span> <span class="n">do_flat</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                __pyx_t_12 = (__pyx_v_do_flat != 0);
                                if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+393:                         <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">cflat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                  if (unlikely(!__pyx_v_cflat.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cflat"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L34_error;}</span> }
                                  __pyx_t_26 = __pyx_v_i;
                                  __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_cflat.data + __pyx_t_26 * __pyx_v_cflat.strides[0]) ))));
                                  goto __pyx_L37;
                                }
                                __pyx_L37:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+394:                     <span class="k">if</span> <span class="n">do_polarization</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                __pyx_t_12 = (__pyx_v_do_polarization != 0);
                                if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+395:                         <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">cpolarization</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                  if (unlikely(!__pyx_v_cpolarization.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("cpolarization"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L34_error;}</span> }
                                  __pyx_t_27 = __pyx_v_i;
                                  __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_cpolarization.data + __pyx_t_27 * __pyx_v_cpolarization.strides[0]) ))));
                                  goto __pyx_L38;
                                }
                                __pyx_L38:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+396:                     <span class="k">if</span> <span class="n">do_solidAngle</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                                __pyx_t_12 = (__pyx_v_do_solidAngle != 0);
                                if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+397:                         <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">csolidAngle</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2'>                                  if (unlikely(!__pyx_v_csolidAngle.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundMemoryviewSliceNogil</span>("csolidAngle"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L34_error;}</span> }
                                  __pyx_t_28 = __pyx_v_i;
                                  __pyx_v_data = (__pyx_v_data / (*((double *) ( /* dim=0 */ (__pyx_v_csolidAngle.data + __pyx_t_28 * __pyx_v_csolidAngle.strides[0]) ))));
                                  goto __pyx_L39;
                                }
                                __pyx_L39:;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+398:                     <span class="n">cdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">data</span></pre>
<pre class='cython code score-4'>                                __pyx_t_29 = __pyx_v_i;
                                *((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_29 * __pyx_v_cdata.strides[0]) )) += __pyx_v_data;
                                goto __pyx_L41;
                                __pyx_L34_error:;
                                {
                                    #ifdef WITH_THREAD
                                    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                                    #endif
                                    #ifdef _OPENMP
                                    #pragma omp flush(__pyx_parallel_exc_type)
                                    #endif /* _OPENMP */
                                    if (!__pyx_parallel_exc_type) {
                                      <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                      __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                    }
                                    #ifdef WITH_THREAD
                                    PyGILState_Release(__pyx_gilstate_save);
                                    #endif
                                }
                                __pyx_parallel_why = 4;
                                goto __pyx_L40;
                                __pyx_L40:;
                                #ifdef _OPENMP
                                #pragma omp critical(__pyx_parallel_lastprivates25)
                                #endif /* _OPENMP */
                                {
                                    __pyx_parallel_temp0 = __pyx_v_data;
                                    __pyx_parallel_temp1 = __pyx_v_i;
                                }
                                __pyx_L41:;
                                #ifdef _OPENMP
                                #pragma omp flush(__pyx_parallel_why)
                                #endif /* _OPENMP */
                            }
                        }
                        #ifdef _OPENMP
                        Py_END_ALLOW_THREADS
                        #else
{
#ifdef WITH_THREAD
                        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                        #endif
                        #endif /* _OPENMP */
                        /* Clean up any temporaries */
                        #ifdef WITH_THREAD
                        PyGILState_Release(__pyx_gilstate_save);
                        #endif
                        #ifndef _OPENMP
}
#endif /* _OPENMP */
                    }
                }
                if (__pyx_parallel_exc_type) {
                  /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                  __pyx_parallel_why = 4;
                }
                if (__pyx_parallel_why) {
                  __pyx_v_data = __pyx_parallel_temp0;
                  __pyx_v_i = __pyx_parallel_temp1;
                  switch (__pyx_parallel_why) {
                        case 3: goto __pyx_L29_return;
                        case 4:
                    {
                        #ifdef WITH_THREAD
                        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
                        #endif
                        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                        <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                        __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                        #ifdef WITH_THREAD
                        PyGILState_Release(__pyx_gilstate_save);
                        #endif
                    }
                    goto __pyx_L30_error;
                  }
                }
            }
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   __builtin_expect(!!(x), 1)
                #define unlikely(x) __builtin_expect(!!(x), 0)
            #endif
          }
</pre><pre class='cython line score-0'>&#xA0;399:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+400:             <span class="k">if</span> <span class="n">do_dummy</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = (__pyx_v_do_dummy != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-53' onclick='toggleDiv(this)'>+401:                 <span class="n">tdata</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (__pyx_t_3) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6);
      if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_tdata = __pyx_t_10;
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
</pre><pre class='cython line score-35' onclick='toggleDiv(this)'>+402:                 <span class="n">cdata</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-35'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyInt_From_npy_int32(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3);
      if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_cdata = __pyx_t_10;
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+403:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&quot;static&quot;</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      {
          #ifdef WITH_THREAD
          PyThreadState *_save;
          Py_UNBLOCK_THREADS
          #endif
          /*try:*/ {
            __pyx_t_2 = __pyx_v_size;
            if (1 == 0) abort();
            {
                #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                    #undef likely
                    #undef unlikely
                    #define likely(x)   (x)
                    #define unlikely(x) (x)
                #endif
                __pyx_t_16 = (__pyx_t_2 - 0) / 1;
                if (__pyx_t_16 &gt; 0)
                {
                    #ifdef _OPENMP
                    #pragma omp parallel
                    #endif /* _OPENMP */
                    {
                        #ifdef _OPENMP
                        #pragma omp for lastprivate(__pyx_v_data) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) schedule(static)
                        #endif /* _OPENMP */
                        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_16; __pyx_t_15++){
                            {
                                __pyx_v_i = 0 + 1 * __pyx_t_15;
                                /* Initialize private variables to invalid values */
                                __pyx_v_data = ((double)__PYX_NAN());
/* … */
          /*finally:*/ {
            /*normal exit:*/{
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L45;
            }
            __pyx_L45:;
          }
      }
      goto __pyx_L42;
    }
    /*else*/ {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+404:                     <span class="n">data</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                                __pyx_t_30 = __pyx_v_i;
                                __pyx_v_data = (*((double *) ( /* dim=0 */ (__pyx_v_tdata.data + __pyx_t_30 * __pyx_v_tdata.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+405:                     <span class="k">if</span> <span class="p">((</span><span class="n">cddummy</span><span class="o">!=</span><span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">cdummy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">cddummy</span><span class="p">))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">cddummy</span><span class="o">==</span><span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="o">!=</span><span class="n">cdummy</span><span class="p">)):</span></pre>
<pre class='cython code score-0'>                                __pyx_t_13 = ((__pyx_v_cddummy != 0.0) != 0);
                                if (!__pyx_t_13) {
                                  goto __pyx_L52_next_or;
                                } else {
                                }
                                __pyx_t_13 = ((fabs((__pyx_v_data - __pyx_v_cdummy)) &gt; __pyx_v_cddummy) != 0);
                                if (!__pyx_t_13) {
                                } else {
                                  __pyx_t_12 = __pyx_t_13;
                                  goto __pyx_L51_bool_binop_done;
                                }
                                __pyx_L52_next_or:;
                                __pyx_t_13 = ((__pyx_v_cddummy == 0.0) != 0);
                                if (__pyx_t_13) {
                                } else {
                                  __pyx_t_12 = __pyx_t_13;
                                  goto __pyx_L51_bool_binop_done;
                                }
                                __pyx_t_13 = ((__pyx_v_data != __pyx_v_cdummy) != 0);
                                __pyx_t_12 = __pyx_t_13;
                                __pyx_L51_bool_binop_done:;
                                if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+406:                         <span class="n">cdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">data</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_31 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_31 * __pyx_v_cdata.strides[0]) )) += __pyx_v_data;
                                  goto __pyx_L50;
                                }
                                /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;407:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+408:                         <span class="n">cdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">cdummy</span></pre>
<pre class='cython code score-0'>                                  __pyx_t_32 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_32 * __pyx_v_cdata.strides[0]) )) += __pyx_v_cdummy;
                                }
                                __pyx_L50:;
                            }
                        }
                    }
                }
            }
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   __builtin_expect(!!(x), 1)
                #define unlikely(x) __builtin_expect(!!(x), 0)
            #endif
          }
</pre><pre class='cython line score-0'>&#xA0;409:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-53' onclick='toggleDiv(this)'>+410:                 <span class="n">cdata</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-53'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (__pyx_t_1) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
      if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_cdata = __pyx_t_10;
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
    }
    __pyx_L42:;
  }
  __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;411: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+412:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&quot;guided&quot;</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_16 = __pyx_v_bins;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_2 = (__pyx_t_16 - 0) / 1;
            if (__pyx_t_2 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_coef) lastprivate(__pyx_v_sum_data) lastprivate(__pyx_v_data) lastprivate(__pyx_v_j) lastprivate(__pyx_v_sum_count) lastprivate(__pyx_v_idx) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) schedule(guided)
                    #endif /* _OPENMP */
                    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_2; __pyx_t_15++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_15;
                            /* Initialize private variables to invalid values */
                            __pyx_v_coef = ((double)__PYX_NAN());
                            __pyx_v_sum_data = ((double)__PYX_NAN());
                            __pyx_v_data = ((double)__PYX_NAN());
                            __pyx_v_j = ((__pyx_t_5numpy_int32_t)0xbad0bad0);
                            __pyx_v_sum_count = ((double)__PYX_NAN());
                            __pyx_v_idx = ((__pyx_t_5numpy_int32_t)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L59;
        }
        __pyx_L59:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+413:             <span class="n">sum_data</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0'>                            __pyx_v_sum_data = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+414:             <span class="n">sum_count</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0'>                            __pyx_v_sum_count = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+415:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">indptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>                            __pyx_t_33 = (__pyx_v_i + 1);
                            __pyx_t_34 = (*((__pyx_t_5numpy_int32_t *) ( /* dim=0 */ (__pyx_v_indptr.data + __pyx_t_33 * __pyx_v_indptr.strides[0]) )));
                            __pyx_t_35 = __pyx_v_i;
                            for (__pyx_t_36 = (*((__pyx_t_5numpy_int32_t *) ( /* dim=0 */ (__pyx_v_indptr.data + __pyx_t_35 * __pyx_v_indptr.strides[0]) ))); __pyx_t_36 &lt; __pyx_t_34; __pyx_t_36+=1) {
                              __pyx_v_j = __pyx_t_36;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+416:                 <span class="n">idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                              __pyx_t_37 = __pyx_v_j;
                              __pyx_v_idx = (*((__pyx_t_5numpy_int32_t *) ( /* dim=0 */ (__pyx_v_indices.data + __pyx_t_37 * __pyx_v_indices.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+417:                 <span class="n">coef</span> <span class="o">=</span> <span class="n">ccoef</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                              __pyx_t_38 = __pyx_v_j;
                              __pyx_v_coef = (*((double *) ( /* dim=0 */ (__pyx_v_ccoef.data + __pyx_t_38 * __pyx_v_ccoef.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+418:                 <span class="k">if</span> <span class="n">coef</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                              __pyx_t_12 = ((__pyx_v_coef == 0.0) != 0);
                              if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+419:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>                                goto __pyx_L64_continue;
                              }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+420:                 <span class="n">data</span> <span class="o">=</span> <span class="n">cdata</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0'>                              __pyx_t_39 = __pyx_v_idx;
                              __pyx_v_data = (*((double *) ( /* dim=0 */ (__pyx_v_cdata.data + __pyx_t_39 * __pyx_v_cdata.strides[0]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+421:                 <span class="k">if</span> <span class="n">do_dummy</span> <span class="ow">and</span> <span class="n">data</span><span class="o">==</span><span class="n">cdummy</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                              __pyx_t_13 = (__pyx_v_do_dummy != 0);
                              if (__pyx_t_13) {
                              } else {
                                __pyx_t_12 = __pyx_t_13;
                                goto __pyx_L68_bool_binop_done;
                              }
                              __pyx_t_13 = ((__pyx_v_data == __pyx_v_cdummy) != 0);
                              __pyx_t_12 = __pyx_t_13;
                              __pyx_L68_bool_binop_done:;
                              if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+422:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>                                goto __pyx_L64_continue;
                              }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+423:                 <span class="n">sum_data</span> <span class="o">=</span> <span class="n">sum_data</span> <span class="o">+</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">data</span></pre>
<pre class='cython code score-0'>                              __pyx_v_sum_data = (__pyx_v_sum_data + (__pyx_v_coef * __pyx_v_data));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+424:                 <span class="n">sum_count</span> <span class="o">=</span> <span class="n">sum_count</span> <span class="o">+</span> <span class="n">coef</span></pre>
<pre class='cython code score-0'>                              __pyx_v_sum_count = (__pyx_v_sum_count + __pyx_v_coef);
                              __pyx_L64_continue:;
                            }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+425:             <span class="n">outData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sum_data</span></pre>
<pre class='cython code score-0'>                            __pyx_t_34 = __pyx_v_i;
                            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_outData.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_outData.diminfo[0].strides) += __pyx_v_sum_data;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+426:             <span class="n">outCount</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sum_count</span></pre>
<pre class='cython code score-0'>                            __pyx_t_36 = __pyx_v_i;
                            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_outCount.rcbuffer-&gt;pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_outCount.diminfo[0].strides) += __pyx_v_sum_count;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+427:             <span class="k">if</span> <span class="n">sum_count</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span></pre>
<pre class='cython code score-0'>                            __pyx_t_12 = ((__pyx_v_sum_count &gt; __pyx_v_epsilon) != 0);
                            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+428:                 <span class="n">outMerge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sum_data</span> <span class="o">/</span> <span class="n">sum_count</span></pre>
<pre class='cython code score-0'>                              __pyx_t_40 = __pyx_v_i;
                              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_outMerge.diminfo[0].strides) += (__pyx_v_sum_data / __pyx_v_sum_count);
                              goto __pyx_L70;
                            }
                            /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;429:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+430:                 <span class="n">outMerge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cdummy</span></pre>
<pre class='cython code score-0'>                              __pyx_t_41 = __pyx_v_i;
                              *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_outMerge.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_outMerge.diminfo[0].strides) += __pyx_v_cdummy;
                            }
                            __pyx_L70:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='cython line score-15' onclick='toggleDiv(this)'>+431:         <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">outPos</span><span class="p">,</span> <span class="n">outMerge</span><span class="p">,</span> <span class="n">outData</span><span class="p">,</span> <span class="n">outCount</span></pre>
<pre class='cython code score-15'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_outPos);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outMerge));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_outMerge));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_outMerge));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outData));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, ((PyObject *)__pyx_v_outData));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_outData));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_outCount));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, ((PyObject *)__pyx_v_outCount));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_outCount));
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;432: </pre>
<pre class='cython line score-0'>&#xA0;433: </pre>
<pre class='cython line score-0'>&#xA0;434: </pre>
<pre class='cython line score-0'>&#xA0;435: <span class="c">################################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;436: <span class="c"># Bidimensionnal regrouping</span></pre>
<pre class='cython line score-0'>&#xA0;437: <span class="c">################################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;438: </pre>
<pre class='cython line score-0'>&#xA0;439: <span class="c">#class HistoBBox2d(object):</span></pre>
<pre class='cython line score-0'>&#xA0;440:     <span class="c">#@cython.boundscheck(False)</span></pre>
<pre class='cython line score-0'>&#xA0;441:     <span class="c">#def __init__(self,</span></pre>
<pre class='cython line score-0'>&#xA0;442:                     <span class="c">#pos0,</span></pre>
<pre class='cython line score-0'>&#xA0;443:                     <span class="c">#delta_pos0,</span></pre>
<pre class='cython line score-0'>&#xA0;444:                     <span class="c">#pos1,</span></pre>
<pre class='cython line score-0'>&#xA0;445:                     <span class="c">#delta_pos1,</span></pre>
<pre class='cython line score-0'>&#xA0;446:                     <span class="c">#bins=(100,36),</span></pre>
<pre class='cython line score-0'>&#xA0;447:                     <span class="c">#pos0Range=None,</span></pre>
<pre class='cython line score-0'>&#xA0;448:                     <span class="c">#pos1Range=None,</span></pre>
<pre class='cython line score-0'>&#xA0;449:                     <span class="c">#mask=None,</span></pre>
<pre class='cython line score-0'>&#xA0;450:                     <span class="c">#mask_checksum=None,</span></pre>
<pre class='cython line score-0'>&#xA0;451:                     <span class="c">#allow_pos0_neg=False,</span></pre>
<pre class='cython line score-0'>&#xA0;452:                     <span class="c">#unit=&quot;undefined&quot;,</span></pre>
<pre class='cython line score-0'>&#xA0;453:                     <span class="c">#chiDiscAtPi=True</span></pre>
<pre class='cython line score-0'>&#xA0;454:                     <span class="c">#):</span></pre>
<pre class='cython line score-0'>&#xA0;455:         <span class="c">#&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;456:         <span class="c">#@param pos0: 1D array with pos0: tth or q_vect</span></pre>
<pre class='cython line score-0'>&#xA0;457:         <span class="c">#@param delta_pos0: 1D array with delta pos0: max center-corner distance</span></pre>
<pre class='cython line score-0'>&#xA0;458:         <span class="c">#@param pos1: 1D array with pos1: chi</span></pre>
<pre class='cython line score-0'>&#xA0;459:         <span class="c">#@param delta_pos1: 1D array with max pos1: max center-corner distance, unused !</span></pre>
<pre class='cython line score-0'>&#xA0;460:         <span class="c">#@param bins: number of output bins (tth=100, chi=36 by default)</span></pre>
<pre class='cython line score-0'>&#xA0;461:         <span class="c">#@param pos0Range: minimum and maximum  of the 2th range</span></pre>
<pre class='cython line score-0'>&#xA0;462:         <span class="c">#@param pos1Range: minimum and maximum  of the chi range</span></pre>
<pre class='cython line score-0'>&#xA0;463:         <span class="c">#@param mask: array (of int8) with masked pixels with 1 (0=not masked)</span></pre>
<pre class='cython line score-0'>&#xA0;464:         <span class="c">#@param allow_pos0_neg: enforce the q&lt;0 is usually not possible  </span></pre>
<pre class='cython line score-0'>&#xA0;465:         <span class="c">#@param chiDiscAtPi: boolean; by default the chi_range is in the range ]-pi,pi[ set to 0 to have the range ]0,2pi[</span></pre>
<pre class='cython line score-0'>&#xA0;466:         <span class="c">#&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;467:         <span class="c">#cdef int i, size, bin0, bin1</span></pre>
<pre class='cython line score-0'>&#xA0;468:         <span class="c">#self.size = pos0.size</span></pre>
<pre class='cython line score-0'>&#xA0;469:         <span class="c">#assert delta_pos0.size == self.size</span></pre>
<pre class='cython line score-0'>&#xA0;470:         <span class="c">#assert pos1.size == self.size</span></pre>
<pre class='cython line score-0'>&#xA0;471:         <span class="c">#assert delta_pos1.size == self.size</span></pre>
<pre class='cython line score-0'>&#xA0;472:         <span class="c">#self.chiDiscAtPi = 1 if chiDiscAtPi else 0</span></pre>
<pre class='cython line score-0'>&#xA0;473:         <span class="c">#self.allow_pos0_neg =  allow_pos0_neg</span></pre>
<pre class='cython line score-0'>&#xA0;474: </pre>
<pre class='cython line score-0'>&#xA0;475:         <span class="c">#try:</span></pre>
<pre class='cython line score-0'>&#xA0;476:             <span class="c">#bins0, bins1 = tuple(bins)</span></pre>
<pre class='cython line score-0'>&#xA0;477:         <span class="c">#except:</span></pre>
<pre class='cython line score-0'>&#xA0;478:             <span class="c">#bins0 = bins1 = bins</span></pre>
<pre class='cython line score-0'>&#xA0;479:         <span class="c">#if bins0 &lt;= 0:</span></pre>
<pre class='cython line score-0'>&#xA0;480:             <span class="c">#bins0 = 1</span></pre>
<pre class='cython line score-0'>&#xA0;481:         <span class="c">#if bins1 &lt;= 0:</span></pre>
<pre class='cython line score-0'>&#xA0;482:             <span class="c">#bins1 = 1</span></pre>
<pre class='cython line score-0'>&#xA0;483:         <span class="c">#self.bins = (int(bins0),int(bins1))</span></pre>
<pre class='cython line score-0'>&#xA0;484:         <span class="c">#self.lut_size = 0</span></pre>
<pre class='cython line score-0'>&#xA0;485:         <span class="c">#if  mask is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;486:             <span class="c">#assert mask.size == self.size</span></pre>
<pre class='cython line score-0'>&#xA0;487:             <span class="c">#self.check_mask = True</span></pre>
<pre class='cython line score-0'>&#xA0;488:             <span class="c">#self.cmask = numpy.ascontiguousarray(mask.ravel(), dtype=numpy.int8)</span></pre>
<pre class='cython line score-0'>&#xA0;489:             <span class="c">#if mask_checksum:</span></pre>
<pre class='cython line score-0'>&#xA0;490:                 <span class="c">#self.mask_checksum = mask_checksum</span></pre>
<pre class='cython line score-0'>&#xA0;491:             <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;492:                 <span class="c">#self.mask_checksum = crc32(mask)</span></pre>
<pre class='cython line score-0'>&#xA0;493:         <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;494:             <span class="c">#self.check_mask = False</span></pre>
<pre class='cython line score-0'>&#xA0;495:             <span class="c">#self.mask_checksum = None</span></pre>
<pre class='cython line score-0'>&#xA0;496: </pre>
<pre class='cython line score-0'>&#xA0;497:         <span class="c">#self.data = self.nnz = self.indices = self.indptr = None</span></pre>
<pre class='cython line score-0'>&#xA0;498:         <span class="c">#self.cpos0 = numpy.ascontiguousarray(pos0.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;499:         <span class="c">#self.dpos0 = numpy.ascontiguousarray(delta_pos0.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;500:         <span class="c">#self.cpos0_sup = numpy.empty_like(self.cpos0)</span></pre>
<pre class='cython line score-0'>&#xA0;501:         <span class="c">#self.cpos0_inf = numpy.empty_like(self.cpos0)</span></pre>
<pre class='cython line score-0'>&#xA0;502:         <span class="c">#self.pos0Range = pos0Range</span></pre>
<pre class='cython line score-0'>&#xA0;503:         <span class="c">#self.pos1Range = pos1Range</span></pre>
<pre class='cython line score-0'>&#xA0;504: </pre>
<pre class='cython line score-0'>&#xA0;505:         <span class="c">#self.cpos1 = numpy.ascontiguousarray((pos1).ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;506:         <span class="c">#self.dpos1 = numpy.ascontiguousarray((delta_pos1).ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;507:         <span class="c">#self.cpos1_sup = numpy.empty_like(self.cpos1)</span></pre>
<pre class='cython line score-0'>&#xA0;508:         <span class="c">#self.cpos1_inf = numpy.empty_like(self.cpos1)</span></pre>
<pre class='cython line score-0'>&#xA0;509:         <span class="c">#self.calc_boundaries(pos0Range, pos1Range)</span></pre>
<pre class='cython line score-0'>&#xA0;510:         <span class="c">#self.delta0 = (self.pos0_max - self.pos0_min) / float(bins0)</span></pre>
<pre class='cython line score-0'>&#xA0;511:         <span class="c">#self.delta1 = (self.pos1_max - self.pos1_min) / float(bins1)</span></pre>
<pre class='cython line score-0'>&#xA0;512:         <span class="c">#self.lut_max_idx = self.calc_lut()</span></pre>
<pre class='cython line score-0'>&#xA0;513:         <span class="c">#self.outPos0 = numpy.linspace(self.pos0_min+0.5*self.delta0, self.pos0_maxin-0.5*self.delta0, bins0)</span></pre>
<pre class='cython line score-0'>&#xA0;514:         <span class="c">#self.outPos1 = numpy.linspace(self.pos1_min+0.5*self.delta1, self.pos1_maxin-0.5*self.delta1, bins1)</span></pre>
<pre class='cython line score-0'>&#xA0;515:         <span class="c">#self.unit=unit</span></pre>
<pre class='cython line score-0'>&#xA0;516:         <span class="c">#self.lut=(self.data,self.indices,self.indptr)</span></pre>
<pre class='cython line score-0'>&#xA0;517:         <span class="c">#self.lut_checksum = crc32(self.data)</span></pre>
<pre class='cython line score-0'>&#xA0;518: </pre>
<pre class='cython line score-0'>&#xA0;519:     <span class="c">#@cython.boundscheck(False)</span></pre>
<pre class='cython line score-0'>&#xA0;520:     <span class="c">#@cython.wraparound(False)</span></pre>
<pre class='cython line score-0'>&#xA0;521:     <span class="c">#def calc_boundaries(self, pos0Range, pos1Range):</span></pre>
<pre class='cython line score-0'>&#xA0;522:         <span class="c">#cdef int size = self.cpos0.size</span></pre>
<pre class='cython line score-0'>&#xA0;523:         <span class="c">#cdef bint check_mask = self.check_mask</span></pre>
<pre class='cython line score-0'>&#xA0;524:         <span class="c">#cdef numpy.int8_t[:] cmask</span></pre>
<pre class='cython line score-0'>&#xA0;525:         <span class="c">#cdef float[:] cpos0, dpos0, cpos0_sup, cpos0_inf</span></pre>
<pre class='cython line score-0'>&#xA0;526:         <span class="c">#cdef float[:] cpos1, dpos1, cpos1_sup, cpos1_inf,</span></pre>
<pre class='cython line score-0'>&#xA0;527:         <span class="c">#cdef float upper0, lower0, pos0_max, pos0_min, c0, d0</span></pre>
<pre class='cython line score-0'>&#xA0;528:         <span class="c">#cdef float upper1, lower1, pos1_max, pos1_min, c1, d1</span></pre>
<pre class='cython line score-0'>&#xA0;529:         <span class="c">#cdef bint allow_pos0_neg=self.allow_pos0_neg</span></pre>
<pre class='cython line score-0'>&#xA0;530:         <span class="c">#cdef bint chiDiscAtPi = self.chiDiscAtPi</span></pre>
<pre class='cython line score-0'>&#xA0;531: </pre>
<pre class='cython line score-0'>&#xA0;532:         <span class="c">#cpos0_sup = self.cpos0_sup</span></pre>
<pre class='cython line score-0'>&#xA0;533:         <span class="c">#cpos0_inf = self.cpos0_inf</span></pre>
<pre class='cython line score-0'>&#xA0;534:         <span class="c">#cpos0 = self.cpos0</span></pre>
<pre class='cython line score-0'>&#xA0;535:         <span class="c">#dpos0 = self.dpos0</span></pre>
<pre class='cython line score-0'>&#xA0;536:         <span class="c">#cpos1_sup = self.cpos1_sup</span></pre>
<pre class='cython line score-0'>&#xA0;537:         <span class="c">#cpos1_inf = self.cpos1_inf</span></pre>
<pre class='cython line score-0'>&#xA0;538:         <span class="c">#cpos1 = self.cpos1</span></pre>
<pre class='cython line score-0'>&#xA0;539:         <span class="c">#dpos1 = self.dpos1</span></pre>
<pre class='cython line score-0'>&#xA0;540:         <span class="c">#pos0_min=cpos0[0]</span></pre>
<pre class='cython line score-0'>&#xA0;541:         <span class="c">#pos0_max=cpos0[0]</span></pre>
<pre class='cython line score-0'>&#xA0;542:         <span class="c">#pos1_min=cpos1[0]</span></pre>
<pre class='cython line score-0'>&#xA0;543:         <span class="c">#pos1_max=cpos1[0]</span></pre>
<pre class='cython line score-0'>&#xA0;544: </pre>
<pre class='cython line score-0'>&#xA0;545:         <span class="c">#if check_mask:</span></pre>
<pre class='cython line score-0'>&#xA0;546:             <span class="c">#cmask = self.cmask</span></pre>
<pre class='cython line score-0'>&#xA0;547:         <span class="c">#with nogil:</span></pre>
<pre class='cython line score-0'>&#xA0;548:             <span class="c">#for idx in range(size):</span></pre>
<pre class='cython line score-0'>&#xA0;549:                 <span class="c">#c0 = cpos0[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;550:                 <span class="c">#d0 = dpos0[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;551:                 <span class="c">#lower0 = c0 - d0</span></pre>
<pre class='cython line score-0'>&#xA0;552:                 <span class="c">#upper0 = c0 + d0</span></pre>
<pre class='cython line score-0'>&#xA0;553:                 <span class="c">#c1 = cpos1[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;554:                 <span class="c">#d1 = dpos1[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;555:                 <span class="c">#lower1 = c1 - d1</span></pre>
<pre class='cython line score-0'>&#xA0;556:                 <span class="c">#upper1 = c1 + d1</span></pre>
<pre class='cython line score-0'>&#xA0;557:                 <span class="c">#if not allow_pos0_neg and lower0&lt;0:</span></pre>
<pre class='cython line score-0'>&#xA0;558:                     <span class="c">#lower0=0</span></pre>
<pre class='cython line score-0'>&#xA0;559:                 <span class="c">#if upper1 &gt; (2-chiDiscAtPi)*pi:</span></pre>
<pre class='cython line score-0'>&#xA0;560:                     <span class="c">#upper1 = (2-chiDiscAtPi)*pi</span></pre>
<pre class='cython line score-0'>&#xA0;561:                 <span class="c">#if lower1 &lt; (-chiDiscAtPi)*pi:</span></pre>
<pre class='cython line score-0'>&#xA0;562:                     <span class="c">#lower1 = (-chiDiscAtPi)*pi</span></pre>
<pre class='cython line score-0'>&#xA0;563:                 <span class="c">#cpos0_sup[idx] = upper0</span></pre>
<pre class='cython line score-0'>&#xA0;564:                 <span class="c">#cpos0_inf[idx] = lower0</span></pre>
<pre class='cython line score-0'>&#xA0;565:                 <span class="c">#cpos1_sup[idx] = upper1</span></pre>
<pre class='cython line score-0'>&#xA0;566:                 <span class="c">#cpos1_inf[idx] = lower1</span></pre>
<pre class='cython line score-0'>&#xA0;567:                 <span class="c">#if not (check_mask and cmask[idx]):</span></pre>
<pre class='cython line score-0'>&#xA0;568:                     <span class="c">#if upper0&gt;pos0_max:</span></pre>
<pre class='cython line score-0'>&#xA0;569:                         <span class="c">#pos0_max = upper0</span></pre>
<pre class='cython line score-0'>&#xA0;570:                     <span class="c">#if lower0&lt;pos0_min:</span></pre>
<pre class='cython line score-0'>&#xA0;571:                         <span class="c">#pos0_min = lower0</span></pre>
<pre class='cython line score-0'>&#xA0;572:                     <span class="c">#if upper1&gt;pos1_max:</span></pre>
<pre class='cython line score-0'>&#xA0;573:                         <span class="c">#pos1_max = upper1</span></pre>
<pre class='cython line score-0'>&#xA0;574:                     <span class="c">#if lower1&lt;pos1_min:</span></pre>
<pre class='cython line score-0'>&#xA0;575:                         <span class="c">#pos1_min = lower1</span></pre>
<pre class='cython line score-0'>&#xA0;576: </pre>
<pre class='cython line score-0'>&#xA0;577:         <span class="c">#if pos0Range is not None and len(pos0Range) &gt; 1:</span></pre>
<pre class='cython line score-0'>&#xA0;578:             <span class="c">#self.pos0_min = min(pos0Range)</span></pre>
<pre class='cython line score-0'>&#xA0;579:             <span class="c">#self.pos0_maxin = max(pos0Range)</span></pre>
<pre class='cython line score-0'>&#xA0;580:         <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;581:             <span class="c">#self.pos0_min = pos0_min</span></pre>
<pre class='cython line score-0'>&#xA0;582:             <span class="c">#self.pos0_maxin = pos0_max</span></pre>
<pre class='cython line score-0'>&#xA0;583: </pre>
<pre class='cython line score-0'>&#xA0;584: </pre>
<pre class='cython line score-0'>&#xA0;585:         <span class="c">#if pos1Range is not None and len(pos1Range) &gt; 1:</span></pre>
<pre class='cython line score-0'>&#xA0;586:             <span class="c">#self.pos1_min = min(pos1Range)</span></pre>
<pre class='cython line score-0'>&#xA0;587:             <span class="c">#self.pos1_maxin = max(pos1Range)</span></pre>
<pre class='cython line score-0'>&#xA0;588:         <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;589:             <span class="c">#self.pos1_min = pos1_min</span></pre>
<pre class='cython line score-0'>&#xA0;590:             <span class="c">#self.pos1_maxin = pos1_max</span></pre>
<pre class='cython line score-0'>&#xA0;591: </pre>
<pre class='cython line score-0'>&#xA0;592:         <span class="c">#if (not allow_pos0_neg) and self.pos0_min &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;593:             <span class="c">#self.pos0_min = 0</span></pre>
<pre class='cython line score-0'>&#xA0;594:         <span class="c">#self.pos0_max = self.pos0_maxin * EPS32</span></pre>
<pre class='cython line score-0'>&#xA0;595:         <span class="c">#self.cpos0_sup = cpos0_sup</span></pre>
<pre class='cython line score-0'>&#xA0;596:         <span class="c">#self.cpos0_inf = cpos0_inf</span></pre>
<pre class='cython line score-0'>&#xA0;597:         <span class="c">#self.pos1_max = self.pos1_maxin * EPS32</span></pre>
<pre class='cython line score-0'>&#xA0;598:         <span class="c">#self.cpos1_sup = cpos1_sup</span></pre>
<pre class='cython line score-0'>&#xA0;599:         <span class="c">#self.cpos1_inf = cpos1_inf</span></pre>
<pre class='cython line score-0'>&#xA0;600: </pre>
<pre class='cython line score-0'>&#xA0;601: </pre>
<pre class='cython line score-0'>&#xA0;602:     <span class="c">#@cython.boundscheck(False)</span></pre>
<pre class='cython line score-0'>&#xA0;603:     <span class="c">#@cython.wraparound(False)</span></pre>
<pre class='cython line score-0'>&#xA0;604:     <span class="c">#@cython.cdivision(True)</span></pre>
<pre class='cython line score-0'>&#xA0;605:     <span class="c">#def calc_lut(self):</span></pre>
<pre class='cython line score-0'>&#xA0;606:         <span class="c">#&#39;calculate the max number of elements in the LUT and populate it&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;607:         <span class="c">#cdef float delta0=self.delta0, pos0_min=self.pos0_min, min0, max0, fbin0_min, fbin0_max</span></pre>
<pre class='cython line score-0'>&#xA0;608:         <span class="c">#cdef float delta1=self.delta1, pos1_min=self.pos1_min, min1, max1, fbin1_min, fbin1_max</span></pre>
<pre class='cython line score-0'>&#xA0;609:         <span class="c">#cdef int bin0_min, bin0_max, bins0 = self.bins[0]</span></pre>
<pre class='cython line score-0'>&#xA0;610:         <span class="c">#cdef int bin1_min, bin1_max, bins1 = self.bins[1]</span></pre>
<pre class='cython line score-0'>&#xA0;611:         <span class="c">#cdef numpy.int32_t k, idx, lut_size, i, j, size=self.size</span></pre>
<pre class='cython line score-0'>&#xA0;612:         <span class="c">#cdef bint check_mask</span></pre>
<pre class='cython line score-0'>&#xA0;613:         <span class="c">#cdef float[:] cpos0_sup = self.cpos0_sup</span></pre>
<pre class='cython line score-0'>&#xA0;614:         <span class="c">#cdef float[:] cpos0_inf = self.cpos0_inf</span></pre>
<pre class='cython line score-0'>&#xA0;615:         <span class="c">#cdef float[:] cpos1_inf = self.cpos1_inf</span></pre>
<pre class='cython line score-0'>&#xA0;616:         <span class="c">#cdef float[:] cpos1_sup = self.cpos1_sup</span></pre>
<pre class='cython line score-0'>&#xA0;617:         <span class="c">#cdef numpy.ndarray[numpy.int32_t, ndim = 2] outMax = numpy.zeros((bins0,bins1), dtype=numpy.int32)</span></pre>
<pre class='cython line score-0'>&#xA0;618:         <span class="c">#cdef numpy.ndarray[numpy.int32_t, ndim = 1] indptr = numpy.zeros((bins0*bins1)+1, dtype=numpy.int32)</span></pre>
<pre class='cython line score-0'>&#xA0;619:         <span class="c">#cdef numpy.ndarray[numpy.int32_t, ndim = 1] indices </span></pre>
<pre class='cython line score-0'>&#xA0;620:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 1] data</span></pre>
<pre class='cython line score-0'>&#xA0;621:         <span class="c">#cdef numpy.int8_t[:] cmask</span></pre>
<pre class='cython line score-0'>&#xA0;622:         <span class="c">#if self.check_mask:</span></pre>
<pre class='cython line score-0'>&#xA0;623:             <span class="c">#cmask = self.cmask</span></pre>
<pre class='cython line score-0'>&#xA0;624:             <span class="c">#check_mask = True</span></pre>
<pre class='cython line score-0'>&#xA0;625:         <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;626:             <span class="c">#check_mask = False</span></pre>
<pre class='cython line score-0'>&#xA0;627: </pre>
<pre class='cython line score-0'>&#xA0;628:     <span class="c">##NOGIL</span></pre>
<pre class='cython line score-0'>&#xA0;629:         <span class="c">#with nogil:</span></pre>
<pre class='cython line score-0'>&#xA0;630:             <span class="c">#for idx in range(size):</span></pre>
<pre class='cython line score-0'>&#xA0;631:                 <span class="c">#if (check_mask) and (cmask[idx]):</span></pre>
<pre class='cython line score-0'>&#xA0;632:                     <span class="c">#continue</span></pre>
<pre class='cython line score-0'>&#xA0;633: </pre>
<pre class='cython line score-0'>&#xA0;634:                 <span class="c">#min0 = cpos0_inf[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;635:                 <span class="c">#max0 = cpos0_sup[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;636:                 <span class="c">#min1 = cpos1_inf[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;637:                 <span class="c">#max1 = cpos1_sup[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;638: </pre>
<pre class='cython line score-0'>&#xA0;639:                 <span class="c">#bin0_min = &lt; int &gt; getBinNr(min0, pos0_min, delta0)</span></pre>
<pre class='cython line score-0'>&#xA0;640:                 <span class="c">#bin0_max = &lt; int &gt; getBinNr(max0, pos0_min, delta0)</span></pre>
<pre class='cython line score-0'>&#xA0;641: </pre>
<pre class='cython line score-0'>&#xA0;642:                 <span class="c">#bin1_min = &lt; int &gt; getBinNr(min1, pos1_min, delta1)</span></pre>
<pre class='cython line score-0'>&#xA0;643:                 <span class="c">#bin1_max = &lt; int &gt; getBinNr(max1, pos1_min, delta1)</span></pre>
<pre class='cython line score-0'>&#xA0;644: </pre>
<pre class='cython line score-0'>&#xA0;645:                 <span class="c">#if (bin0_max &lt; 0) or (bin0_min &gt;= bins0) or (bin1_max &lt; 0) or (bin1_min &gt;= bins1):</span></pre>
<pre class='cython line score-0'>&#xA0;646:                     <span class="c">#continue</span></pre>
<pre class='cython line score-0'>&#xA0;647: </pre>
<pre class='cython line score-0'>&#xA0;648:                 <span class="c">#if bin0_max &gt;= bins0 :</span></pre>
<pre class='cython line score-0'>&#xA0;649:                     <span class="c">#bin0_max = bins0 - 1</span></pre>
<pre class='cython line score-0'>&#xA0;650:                 <span class="c">#if  bin0_min &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;651:                     <span class="c">#bin0_min = 0</span></pre>
<pre class='cython line score-0'>&#xA0;652:                 <span class="c">#if bin1_max &gt;= bins1 :</span></pre>
<pre class='cython line score-0'>&#xA0;653:                     <span class="c">#bin1_max = bins1 - 1</span></pre>
<pre class='cython line score-0'>&#xA0;654:                 <span class="c">#if  bin1_min &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;655:                     <span class="c">#bin1_min = 0</span></pre>
<pre class='cython line score-0'>&#xA0;656: </pre>
<pre class='cython line score-0'>&#xA0;657:                 <span class="c">#for i in range(bin0_min, bin0_max+1):</span></pre>
<pre class='cython line score-0'>&#xA0;658:                     <span class="c">#for j in range(bin1_min , bin1_max+1):</span></pre>
<pre class='cython line score-0'>&#xA0;659:                         <span class="c">#outMax[i, j] +=  1</span></pre>
<pre class='cython line score-0'>&#xA0;660: </pre>
<pre class='cython line score-0'>&#xA0;661:         <span class="c">#self.nnz = outMax.sum()</span></pre>
<pre class='cython line score-0'>&#xA0;662:         <span class="c">#indptr[1:] = outMax.cumsum()</span></pre>
<pre class='cython line score-0'>&#xA0;663:         <span class="c">#self.indptr = indptr</span></pre>
<pre class='cython line score-0'>&#xA0;664: <span class="c">##        self.lut_size = lut_size = outMax.max()</span></pre>
<pre class='cython line score-0'>&#xA0;665:         <span class="c">##just recycle the outMax array</span></pre>
<pre class='cython line score-0'>&#xA0;666:         <span class="c">##outMax = numpy.zeros((bins0,bins1), dtype=numpy.int32)</span></pre>
<pre class='cython line score-0'>&#xA0;667:         <span class="c">#memset(&amp;outMax[0,0], 0, bins0*bins1*sizeof(numpy.int32_t))</span></pre>
<pre class='cython line score-0'>&#xA0;668: </pre>
<pre class='cython line score-0'>&#xA0;669:         <span class="c">#lut_nbytes = self.nnz * (sizeof(numpy.float64_t)+sizeof(numpy.int32_t)) + bins0*bins1*sizeof(numpy.int32_t)</span></pre>
<pre class='cython line score-0'>&#xA0;670:         <span class="c">#if (os.name == &quot;posix&quot;) and (&quot;SC_PAGE_SIZE&quot; in os.sysconf_names) and (&quot;SC_PHYS_PAGES&quot; in os.sysconf_names):</span></pre>
<pre class='cython line score-0'>&#xA0;671:             <span class="c">#memsize =  os.sysconf(&quot;SC_PAGE_SIZE&quot;)*os.sysconf(&quot;SC_PHYS_PAGES&quot;)</span></pre>
<pre class='cython line score-0'>&#xA0;672:             <span class="c">#if memsize &lt;  lut_nbytes:</span></pre>
<pre class='cython line score-0'>&#xA0;673:                 <span class="c">#raise MemoryError(&quot;CSR Matrix is %.3fGB whereas the memory of the system is only %s&quot;%(lut_nbytes, memsize))</span></pre>
<pre class='cython line score-0'>&#xA0;674:         <span class="c">##else hope we have enough memory</span></pre>
<pre class='cython line score-0'>&#xA0;675:         <span class="c">#data = numpy.zeros(self.nnz,dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;676:         <span class="c">#indices = numpy.zeros(self.nnz,dtype=numpy.int32)</span></pre>
<pre class='cython line score-0'>&#xA0;677: <span class="c">##        lut = numpy.recarray(shape=(bins0, bins1, lut_size),dtype=[(&quot;idx&quot;,numpy.int32),(&quot;coef&quot;,numpy.float64)])</span></pre>
<pre class='cython line score-0'>&#xA0;678: <span class="c">##        memset(&amp;lut[0,0,0], 0, lut_nbytes)</span></pre>
<pre class='cython line score-0'>&#xA0;679:         <span class="c">#with nogil:</span></pre>
<pre class='cython line score-0'>&#xA0;680:             <span class="c">#for idx in range(size):</span></pre>
<pre class='cython line score-0'>&#xA0;681:                 <span class="c">#if (check_mask) and cmask[idx]:</span></pre>
<pre class='cython line score-0'>&#xA0;682:                     <span class="c">#continue</span></pre>
<pre class='cython line score-0'>&#xA0;683: </pre>
<pre class='cython line score-0'>&#xA0;684:                 <span class="c">#min0 = cpos0_inf[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;685:                 <span class="c">#max0 = cpos0_sup[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;686:                 <span class="c">#min1 = cpos1_inf[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;687:                 <span class="c">#max1 = cpos1_sup[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;688: </pre>
<pre class='cython line score-0'>&#xA0;689:                 <span class="c">#fbin0_min = getBinNr(min0, pos0_min, delta0)</span></pre>
<pre class='cython line score-0'>&#xA0;690:                 <span class="c">#fbin0_max = getBinNr(max0, pos0_min, delta0)</span></pre>
<pre class='cython line score-0'>&#xA0;691:                 <span class="c">#fbin1_min = getBinNr(min1, pos1_min, delta1)</span></pre>
<pre class='cython line score-0'>&#xA0;692:                 <span class="c">#fbin1_max = getBinNr(max1, pos1_min, delta1)</span></pre>
<pre class='cython line score-0'>&#xA0;693: </pre>
<pre class='cython line score-0'>&#xA0;694:                 <span class="c">#bin0_min = &lt;int&gt; fbin0_min</span></pre>
<pre class='cython line score-0'>&#xA0;695:                 <span class="c">#bin0_max = &lt;int&gt; fbin0_max</span></pre>
<pre class='cython line score-0'>&#xA0;696:                 <span class="c">#bin1_min = &lt;int&gt; fbin1_min</span></pre>
<pre class='cython line score-0'>&#xA0;697:                 <span class="c">#bin1_max = &lt;int&gt; fbin1_max</span></pre>
<pre class='cython line score-0'>&#xA0;698: </pre>
<pre class='cython line score-0'>&#xA0;699:                 <span class="c">#if (bin0_max &lt; 0) or (bin0_min &gt;= bins0) or (bin1_max &lt; 0) or (bin1_min &gt;= bins1):</span></pre>
<pre class='cython line score-0'>&#xA0;700:                     <span class="c">#continue</span></pre>
<pre class='cython line score-0'>&#xA0;701: </pre>
<pre class='cython line score-0'>&#xA0;702:                 <span class="c">#if bin0_max &gt;= bins0 :</span></pre>
<pre class='cython line score-0'>&#xA0;703:                     <span class="c">#bin0_max = bins0 - 1</span></pre>
<pre class='cython line score-0'>&#xA0;704:                 <span class="c">#if  bin0_min &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;705:                     <span class="c">#bin0_min = 0</span></pre>
<pre class='cython line score-0'>&#xA0;706:                 <span class="c">#if bin1_max &gt;= bins1 :</span></pre>
<pre class='cython line score-0'>&#xA0;707:                     <span class="c">#bin1_max = bins1 - 1</span></pre>
<pre class='cython line score-0'>&#xA0;708:                 <span class="c">#if  bin1_min &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;709:                     <span class="c">#bin1_min = 0</span></pre>
<pre class='cython line score-0'>&#xA0;710: </pre>
<pre class='cython line score-0'>&#xA0;711:                 <span class="c">#if bin0_min == bin0_max:</span></pre>
<pre class='cython line score-0'>&#xA0;712:                     <span class="c">#if bin1_min == bin1_max:</span></pre>
<pre class='cython line score-0'>&#xA0;713:                         <span class="c">##All pixel is within a single bin</span></pre>
<pre class='cython line score-0'>&#xA0;714:                         <span class="c">#k = outMax[bin0_min, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;715:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;716:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_min]+k] = onef</span></pre>
<pre class='cython line score-0'>&#xA0;717: <span class="c">##                        lut[bin0_min, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;718: <span class="c">##                        lut[bin0_min, bin1_min, k].coef = onef</span></pre>
<pre class='cython line score-0'>&#xA0;719:                         <span class="c">#outMax[bin0_min, bin1_min]= k+1</span></pre>
<pre class='cython line score-0'>&#xA0;720: </pre>
<pre class='cython line score-0'>&#xA0;721:                     <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;722:                         <span class="c">##spread on more than 2 bins</span></pre>
<pre class='cython line score-0'>&#xA0;723:                         <span class="c">#deltaD = (&lt; float &gt; (bin1_min + 1)) - fbin1_min</span></pre>
<pre class='cython line score-0'>&#xA0;724:                         <span class="c">#deltaU = fbin1_max - ( bin1_max)</span></pre>
<pre class='cython line score-0'>&#xA0;725:                         <span class="c">#deltaA = 1.0 / (fbin1_max - fbin1_min)</span></pre>
<pre class='cython line score-0'>&#xA0;726: </pre>
<pre class='cython line score-0'>&#xA0;727:                         <span class="c">#k = outMax[bin0_min, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;728:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;729:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_min]+k] = deltaA * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;730: <span class="c">##                        lut[bin0_min, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;731: <span class="c">##                        lut[bin0_min, bin1_min, k].coef =  deltaA * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;732:                         <span class="c">#outMax[bin0_min, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;733: </pre>
<pre class='cython line score-0'>&#xA0;734:                         <span class="c">#k = outMax[bin0_min, bin1_max]</span></pre>
<pre class='cython line score-0'>&#xA0;735:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_max]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;736:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_max]+k] = deltaA * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;737: <span class="c">##                        lut[bin0_min, bin1_max, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;738: <span class="c">##                        lut[bin0_min, bin1_max, k].coef =  deltaA * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;739:                         <span class="c">#outMax[bin0_min, bin1_max] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;740: </pre>
<pre class='cython line score-0'>&#xA0;741:                         <span class="c">#for j in range(bin1_min + 1, bin1_max):</span></pre>
<pre class='cython line score-0'>&#xA0;742:                             <span class="c">#k = outMax[bin0_min, j]</span></pre>
<pre class='cython line score-0'>&#xA0;743:                             <span class="c">#indices[indptr[bin0_min*bins1+j]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;744:                             <span class="c">#data[indptr[bin0_min*bins1+j]+k] = deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;745: <span class="c">##                            lut[bin0_min, j, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;746: <span class="c">##                            lut[bin0_min, j, k].coef =  deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;747:                             <span class="c">#outMax[bin0_min, j] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;748: </pre>
<pre class='cython line score-0'>&#xA0;749:                 <span class="c">#else: #spread on more than 2 bins in dim 0</span></pre>
<pre class='cython line score-0'>&#xA0;750:                     <span class="c">#if bin1_min == bin1_max:</span></pre>
<pre class='cython line score-0'>&#xA0;751:                         <span class="c">##All pixel fall on 1 bins in dim 1</span></pre>
<pre class='cython line score-0'>&#xA0;752:                         <span class="c">#deltaA = 1.0 / (fbin0_max - fbin0_min)</span></pre>
<pre class='cython line score-0'>&#xA0;753:                         <span class="c">#deltaL = (&lt; float &gt; (bin0_min + 1)) - fbin0_min</span></pre>
<pre class='cython line score-0'>&#xA0;754: </pre>
<pre class='cython line score-0'>&#xA0;755:                         <span class="c">#k = outMax[bin0_min, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;756:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;757:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_min]+k] = deltaA * deltaL</span></pre>
<pre class='cython line score-0'>&#xA0;758: <span class="c">##                        lut[bin0_min, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;759: <span class="c">##                        lut[bin0_min, bin1_min, k].coef =  deltaA * deltaL</span></pre>
<pre class='cython line score-0'>&#xA0;760:                         <span class="c">#outMax[bin0_min, bin1_min] = k+1</span></pre>
<pre class='cython line score-0'>&#xA0;761: </pre>
<pre class='cython line score-0'>&#xA0;762:                         <span class="c">#deltaR = fbin0_max - (&lt; float &gt; bin0_max)</span></pre>
<pre class='cython line score-0'>&#xA0;763: </pre>
<pre class='cython line score-0'>&#xA0;764:                         <span class="c">#k = outMax[bin0_max, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;765:                         <span class="c">#indices[indptr[bin0_max*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;766:                         <span class="c">#data[indptr[bin0_max*bins1+bin1_min]+k] = deltaA * deltaR</span></pre>
<pre class='cython line score-0'>&#xA0;767: <span class="c">##                        lut[bin0_max, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;768: <span class="c">##                        lut[bin0_max, bin1_min, k].coef =  deltaA * deltaR</span></pre>
<pre class='cython line score-0'>&#xA0;769:                         <span class="c">#outMax[bin0_max, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;770: </pre>
<pre class='cython line score-0'>&#xA0;771:                         <span class="c">#for i in range(bin0_min + 1, bin0_max):</span></pre>
<pre class='cython line score-0'>&#xA0;772:                             <span class="c">#k = outMax[i, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;773:                             <span class="c">#indices[indptr[i*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;774:                             <span class="c">#data[indptr[i*bins1+bin1_min]+k] = deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;775: <span class="c">##                            lut[i, bin1_min ,k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;776: <span class="c">##                            lut[i, bin1_min, k].coef =  deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;777:                             <span class="c">#outMax[i, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;778: </pre>
<pre class='cython line score-0'>&#xA0;779:                     <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;780:                         <span class="c">##spread on n pix in dim0 and m pixel in dim1:</span></pre>
<pre class='cython line score-0'>&#xA0;781:                         <span class="c">#deltaL = (&lt; float &gt; (bin0_min + 1)) - fbin0_min</span></pre>
<pre class='cython line score-0'>&#xA0;782:                         <span class="c">#deltaR = fbin0_max - (&lt; float &gt; bin0_max)</span></pre>
<pre class='cython line score-0'>&#xA0;783:                         <span class="c">#deltaD = (&lt; float &gt; (bin1_min + 1)) - fbin1_min</span></pre>
<pre class='cython line score-0'>&#xA0;784:                         <span class="c">#deltaU = fbin1_max - (&lt; float &gt; bin1_max)</span></pre>
<pre class='cython line score-0'>&#xA0;785:                         <span class="c">#deltaA = 1.0 / ((fbin0_max - fbin0_min) * (fbin1_max - fbin1_min))</span></pre>
<pre class='cython line score-0'>&#xA0;786: </pre>
<pre class='cython line score-0'>&#xA0;787:                         <span class="c">#k = outMax[bin0_min, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;788:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;789:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_min]+k] = deltaA * deltaL * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;790: <span class="c">##                        lut[bin0_min, bin1_min ,k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;791: <span class="c">##                        lut[bin0_min, bin1_min, k].coef =  deltaA * deltaL * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;792:                         <span class="c">#outMax[bin0_min, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;793: </pre>
<pre class='cython line score-0'>&#xA0;794:                         <span class="c">#k = outMax[bin0_min, bin1_max]</span></pre>
<pre class='cython line score-0'>&#xA0;795:                         <span class="c">#indices[indptr[bin0_min*bins1+bin1_max]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;796:                         <span class="c">#data[indptr[bin0_min*bins1+bin1_max]+k] = deltaA * deltaL * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;797: <span class="c">##                        lut[bin0_min, bin1_max, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;798: <span class="c">##                        lut[bin0_min, bin1_max, k].coef =  deltaA * deltaL * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;799:                         <span class="c">#outMax[bin0_min, bin1_max] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;800: </pre>
<pre class='cython line score-0'>&#xA0;801:                         <span class="c">#k = outMax[bin0_max, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;802:                         <span class="c">#indices[indptr[bin0_max*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;803:                         <span class="c">#data[indptr[bin0_max*bins1+bin1_min]+k] = deltaA * deltaR * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;804: <span class="c">##                        lut[bin0_max, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;805: <span class="c">##                        lut[bin0_max, bin1_min, k].coef =  deltaA * deltaR * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;806:                         <span class="c">#outMax[bin0_max, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;807: </pre>
<pre class='cython line score-0'>&#xA0;808:                         <span class="c">#k = outMax[bin0_max, bin1_max]</span></pre>
<pre class='cython line score-0'>&#xA0;809:                         <span class="c">#indices[indptr[bin0_max*bins1+bin1_max]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;810:                         <span class="c">#data[indptr[bin0_max*bins1+bin1_max]+k] = deltaA * deltaR * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;811: <span class="c">##                        lut[bin0_max, bin1_max, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;812: <span class="c">##                        lut[bin0_max, bin1_max, k].coef =  deltaA * deltaR * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;813:                         <span class="c">#outMax[bin0_max, bin1_max] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;814: </pre>
<pre class='cython line score-0'>&#xA0;815:                         <span class="c">#for i in range(bin0_min + 1, bin0_max):</span></pre>
<pre class='cython line score-0'>&#xA0;816:                             <span class="c">#k = outMax[i, bin1_min]</span></pre>
<pre class='cython line score-0'>&#xA0;817:                             <span class="c">#indices[indptr[i*bins1+bin1_min]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;818:                             <span class="c">#data[indptr[i*bins1+bin1_min]+k] = deltaA * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;819: <span class="c">##                            lut[i, bin1_min, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;820: <span class="c">##                            lut[i, bin1_min, k].coef =  deltaA * deltaD</span></pre>
<pre class='cython line score-0'>&#xA0;821:                             <span class="c">#outMax[i, bin1_min] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;822: </pre>
<pre class='cython line score-0'>&#xA0;823:                             <span class="c">#for j in range(bin1_min + 1, bin1_max):</span></pre>
<pre class='cython line score-0'>&#xA0;824:                                 <span class="c">#k = outMax[i, j]</span></pre>
<pre class='cython line score-0'>&#xA0;825:                                 <span class="c">#indices[indptr[i*bins1+j]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;826:                                 <span class="c">#data[indptr[i*bins1+j]+k] = deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;827: <span class="c">##                                lut[i, j, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;828: <span class="c">##                                lut[i, j, k].coef =  deltaA</span></pre>
<pre class='cython line score-0'>&#xA0;829:                                 <span class="c">#outMax[i, j] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;830: </pre>
<pre class='cython line score-0'>&#xA0;831:                             <span class="c">#k = outMax[i, bin1_max]</span></pre>
<pre class='cython line score-0'>&#xA0;832:                             <span class="c">#indices[indptr[i*bins1+bin1_max]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;833:                             <span class="c">#data[indptr[i*bins1+bin1_max]+k] = deltaA * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;834: <span class="c">##                            lut[i, bin1_max, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;835: <span class="c">##                            lut[i, bin1_max, k].coef =  deltaA * deltaU</span></pre>
<pre class='cython line score-0'>&#xA0;836:                             <span class="c">#outMax[i, bin1_max] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;837: </pre>
<pre class='cython line score-0'>&#xA0;838:                         <span class="c">#for j in range(bin1_min + 1, bin1_max):</span></pre>
<pre class='cython line score-0'>&#xA0;839:                             <span class="c">#k = outMax[bin0_min, j]</span></pre>
<pre class='cython line score-0'>&#xA0;840:                             <span class="c">#indices[indptr[bin0_min*bins1+j]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;841:                             <span class="c">#data[indptr[bin0_min*bins1+j]+k] = deltaA * deltaL</span></pre>
<pre class='cython line score-0'>&#xA0;842: <span class="c">##                            lut[bin0_min, j, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;843: <span class="c">##                            lut[bin0_min, j, k].coef =  deltaA * deltaL</span></pre>
<pre class='cython line score-0'>&#xA0;844:                             <span class="c">#outMax[bin0_min, j] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;845: </pre>
<pre class='cython line score-0'>&#xA0;846:                             <span class="c">#k = outMax[bin0_max, j]</span></pre>
<pre class='cython line score-0'>&#xA0;847:                             <span class="c">#indices[indptr[bin0_max*bins1+j]+k] = idx</span></pre>
<pre class='cython line score-0'>&#xA0;848:                             <span class="c">#data[indptr[bin0_max*bins1+j]+k] = deltaA * deltaR</span></pre>
<pre class='cython line score-0'>&#xA0;849: <span class="c">##                            lut[bin0_max, j, k].idx = idx</span></pre>
<pre class='cython line score-0'>&#xA0;850: <span class="c">##                            lut[bin0_max, j, k].coef =  deltaA * deltaR</span></pre>
<pre class='cython line score-0'>&#xA0;851:                             <span class="c">#outMax[bin0_max, j] = k + 1</span></pre>
<pre class='cython line score-0'>&#xA0;852: </pre>
<pre class='cython line score-0'>&#xA0;853:         <span class="c">#self.data = data</span></pre>
<pre class='cython line score-0'>&#xA0;854:         <span class="c">#self.indices = indices</span></pre>
<pre class='cython line score-0'>&#xA0;855:         <span class="c">#return outMax</span></pre>
<pre class='cython line score-0'>&#xA0;856: </pre>
<pre class='cython line score-0'>&#xA0;857:     <span class="c">#@cython.cdivision(True)</span></pre>
<pre class='cython line score-0'>&#xA0;858:     <span class="c">#@cython.boundscheck(False)</span></pre>
<pre class='cython line score-0'>&#xA0;859:     <span class="c">#@cython.wraparound(False)</span></pre>
<pre class='cython line score-0'>&#xA0;860:     <span class="c">#def integrate(self, weights, dummy=None, delta_dummy=None, dark=None, flat=None, solidAngle=None, polarization=None):</span></pre>
<pre class='cython line score-0'>&#xA0;861:         <span class="c">#&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;862:         <span class="c">#Actually perform the 2D integration which in this case looks more like a matrix-vector product</span></pre>
<pre class='cython line score-0'>&#xA0;863: </pre>
<pre class='cython line score-0'>&#xA0;864:         <span class="c">#@param weights: input image</span></pre>
<pre class='cython line score-0'>&#xA0;865:         <span class="c">#@type weights: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;866:         <span class="c">#@param dummy: value for dead pixels (optional)</span></pre>
<pre class='cython line score-0'>&#xA0;867:         <span class="c">#@type dummy: float</span></pre>
<pre class='cython line score-0'>&#xA0;868:         <span class="c">#@param delta_dummy: precision for dead-pixel value in dynamic masking</span></pre>
<pre class='cython line score-0'>&#xA0;869:         <span class="c">#@type delta_dummy: float</span></pre>
<pre class='cython line score-0'>&#xA0;870:         <span class="c">#@param dark: array with the dark-current value to be subtracted (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;871:         <span class="c">#@type dark: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;872:         <span class="c">#@param flat: array with the dark-current value to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;873:         <span class="c">#@type flat: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;874:         <span class="c">#@param solidAngle: array with the solid angle of each pixel to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;875:         <span class="c">#@type solidAngle: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;876:         <span class="c">#@param polarization: array with the polarization correction values to be divided by (if any)</span></pre>
<pre class='cython line score-0'>&#xA0;877:         <span class="c">#@type polarization: ndarray</span></pre>
<pre class='cython line score-0'>&#xA0;878:         <span class="c">#@return:  I(2d), edges0(1d), edges1(1d), weighted histogram(2d), unweighted histogram (2d)</span></pre>
<pre class='cython line score-0'>&#xA0;879:         <span class="c">#@rtype: 5-tuple of ndarrays</span></pre>
<pre class='cython line score-0'>&#xA0;880: </pre>
<pre class='cython line score-0'>&#xA0;881:         <span class="c">#&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;882:         <span class="c">#cdef int i=0, j=0, idx=0, bins0=self.bins[0], bins1=self.bins[1], bins=bins0*bins1, size=self.size</span></pre>
<pre class='cython line score-0'>&#xA0;883:         <span class="c">#cdef double sum_data=0.0, sum_count=0.0, epsilon=1e-10</span></pre>
<pre class='cython line score-0'>&#xA0;884:         <span class="c">#cdef float data=0, coef=0, cdummy=0, cddummy=0</span></pre>
<pre class='cython line score-0'>&#xA0;885:         <span class="c">#cdef bint do_dummy=False, do_dark=False, do_flat=False, do_polarization=False, do_solidAngle=False</span></pre>
<pre class='cython line score-0'>&#xA0;886:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 2] outData = numpy.zeros(self.bins, dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;887:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 2] outCount = numpy.zeros(self.bins, dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;888:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 2] outMerge = numpy.zeros(self.bins, dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;889:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 1] outData_1d = outData.ravel()</span></pre>
<pre class='cython line score-0'>&#xA0;890:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 1] outCount_1d = outCount.ravel()</span></pre>
<pre class='cython line score-0'>&#xA0;891:         <span class="c">#cdef numpy.ndarray[numpy.float64_t, ndim = 1] outMerge_1d = outMerge.ravel()</span></pre>
<pre class='cython line score-0'>&#xA0;892: </pre>
<pre class='cython line score-0'>&#xA0;893:         <span class="c">#cdef float[:] ccoef = self.data, cdata, tdata, cflat, cdark, csolidAngle, cpolarization</span></pre>
<pre class='cython line score-0'>&#xA0;894:         <span class="c">#cdef numpy.int32_t[:] indices = self.indices, indptr = self.indptr</span></pre>
<pre class='cython line score-0'>&#xA0;895: </pre>
<pre class='cython line score-0'>&#xA0;896:         <span class="c">#assert size == weights.size</span></pre>
<pre class='cython line score-0'>&#xA0;897: </pre>
<pre class='cython line score-0'>&#xA0;898:         <span class="c">#if dummy is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;899:             <span class="c">#do_dummy = True</span></pre>
<pre class='cython line score-0'>&#xA0;900:             <span class="c">#cdummy =  &lt;float&gt;float(dummy)</span></pre>
<pre class='cython line score-0'>&#xA0;901:             <span class="c">#if delta_dummy is None:</span></pre>
<pre class='cython line score-0'>&#xA0;902:                 <span class="c">#cddummy = &lt;float&gt;0.0</span></pre>
<pre class='cython line score-0'>&#xA0;903:             <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;904:                 <span class="c">#cddummy = &lt;float&gt;float(delta_dummy)</span></pre>
<pre class='cython line score-0'>&#xA0;905: </pre>
<pre class='cython line score-0'>&#xA0;906:         <span class="c">#if flat is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;907:             <span class="c">#do_flat = True</span></pre>
<pre class='cython line score-0'>&#xA0;908:             <span class="c">#assert flat.size == size</span></pre>
<pre class='cython line score-0'>&#xA0;909:             <span class="c">#cflat = numpy.ascontiguousarray(flat.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;910:         <span class="c">#if dark is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;911:             <span class="c">#do_dark = True</span></pre>
<pre class='cython line score-0'>&#xA0;912:             <span class="c">#assert dark.size == size</span></pre>
<pre class='cython line score-0'>&#xA0;913:             <span class="c">#cdark = numpy.ascontiguousarray(dark.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;914:         <span class="c">#if solidAngle is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;915:             <span class="c">#do_solidAngle = True</span></pre>
<pre class='cython line score-0'>&#xA0;916:             <span class="c">#assert solidAngle.size == size</span></pre>
<pre class='cython line score-0'>&#xA0;917:             <span class="c">#csolidAngle = numpy.ascontiguousarray(solidAngle.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;918:         <span class="c">#if polarization is not None:</span></pre>
<pre class='cython line score-0'>&#xA0;919:             <span class="c">#do_polarization = True</span></pre>
<pre class='cython line score-0'>&#xA0;920:             <span class="c">#assert polarization.size == size</span></pre>
<pre class='cython line score-0'>&#xA0;921:             <span class="c">#cpolarization = numpy.ascontiguousarray(polarization.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;922: </pre>
<pre class='cython line score-0'>&#xA0;923:         <span class="c">#if (do_dark + do_flat + do_polarization + do_solidAngle):</span></pre>
<pre class='cython line score-0'>&#xA0;924:             <span class="c">#tdata = numpy.ascontiguousarray(weights.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;925:             <span class="c">#cdata = numpy.zeros(size,dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;926:             <span class="c">#if do_dummy:</span></pre>
<pre class='cython line score-0'>&#xA0;927:                 <span class="c">#for i in prange(size, nogil=True, schedule=&quot;static&quot;):</span></pre>
<pre class='cython line score-0'>&#xA0;928:                     <span class="c">#data = tdata[i]</span></pre>
<pre class='cython line score-0'>&#xA0;929:                     <span class="c">#if ((cddummy!=0) and (fabs(data-cdummy) &gt; cddummy)) or ((cddummy==0) and (data!=cdummy)):</span></pre>
<pre class='cython line score-0'>&#xA0;930:                         <span class="c">##Nota: -= and /= operatore are seen as reduction in cython parallel.</span></pre>
<pre class='cython line score-0'>&#xA0;931:                         <span class="c">#if do_dark:</span></pre>
<pre class='cython line score-0'>&#xA0;932:                             <span class="c">#data = data - cdark[i]</span></pre>
<pre class='cython line score-0'>&#xA0;933:                         <span class="c">#if do_flat:</span></pre>
<pre class='cython line score-0'>&#xA0;934:                             <span class="c">#data = data / cflat[i]</span></pre>
<pre class='cython line score-0'>&#xA0;935:                         <span class="c">#if do_polarization:</span></pre>
<pre class='cython line score-0'>&#xA0;936:                             <span class="c">#data = data / cpolarization[i]</span></pre>
<pre class='cython line score-0'>&#xA0;937:                         <span class="c">#if do_solidAngle:</span></pre>
<pre class='cython line score-0'>&#xA0;938:                             <span class="c">#data = data / csolidAngle[i]</span></pre>
<pre class='cython line score-0'>&#xA0;939:                         <span class="c">#cdata[i]+=data</span></pre>
<pre class='cython line score-0'>&#xA0;940:                     <span class="c">#else: #set all dummy_like values to cdummy. simplifies further processing</span></pre>
<pre class='cython line score-0'>&#xA0;941:                         <span class="c">#cdata[i]+=cdummy</span></pre>
<pre class='cython line score-0'>&#xA0;942:             <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;943:                 <span class="c">#for i in prange(size, nogil=True, schedule=&quot;static&quot;):</span></pre>
<pre class='cython line score-0'>&#xA0;944:                     <span class="c">#data = tdata[i]</span></pre>
<pre class='cython line score-0'>&#xA0;945:                     <span class="c">#if do_dark:</span></pre>
<pre class='cython line score-0'>&#xA0;946:                         <span class="c">#data = data - cdark[i]</span></pre>
<pre class='cython line score-0'>&#xA0;947:                     <span class="c">#if do_flat:</span></pre>
<pre class='cython line score-0'>&#xA0;948:                         <span class="c">#data = data / cflat[i]</span></pre>
<pre class='cython line score-0'>&#xA0;949:                     <span class="c">#if do_polarization:</span></pre>
<pre class='cython line score-0'>&#xA0;950:                         <span class="c">#data = data / cpolarization[i]</span></pre>
<pre class='cython line score-0'>&#xA0;951:                     <span class="c">#if do_solidAngle:</span></pre>
<pre class='cython line score-0'>&#xA0;952:                         <span class="c">#data = data / csolidAngle[i]</span></pre>
<pre class='cython line score-0'>&#xA0;953:                     <span class="c">#cdata[i]+=data</span></pre>
<pre class='cython line score-0'>&#xA0;954:         <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;955:             <span class="c">#if do_dummy:</span></pre>
<pre class='cython line score-0'>&#xA0;956:                 <span class="c">#tdata = numpy.ascontiguousarray(weights.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;957:                 <span class="c">#cdata = numpy.zeros(size,dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;958:                 <span class="c">#for i in prange(size, nogil=True, schedule=&quot;static&quot;):</span></pre>
<pre class='cython line score-0'>&#xA0;959:                     <span class="c">#data = tdata[i]</span></pre>
<pre class='cython line score-0'>&#xA0;960:                     <span class="c">#if ((cddummy!=0) and (fabs(data-cdummy) &gt; cddummy)) or ((cddummy==0) and (data!=cdummy)):</span></pre>
<pre class='cython line score-0'>&#xA0;961:                         <span class="c">#cdata[i]+=data</span></pre>
<pre class='cython line score-0'>&#xA0;962:                     <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;963:                         <span class="c">#cdata[i]+=cdummy</span></pre>
<pre class='cython line score-0'>&#xA0;964:             <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;965:                 <span class="c">#cdata = numpy.ascontiguousarray(weights.ravel(), dtype=numpy.float64)</span></pre>
<pre class='cython line score-0'>&#xA0;966: </pre>
<pre class='cython line score-0'>&#xA0;967:         <span class="c">#for i in prange(bins, nogil=True, schedule=&quot;guided&quot;):</span></pre>
<pre class='cython line score-0'>&#xA0;968:             <span class="c">#sum_data = 0.0</span></pre>
<pre class='cython line score-0'>&#xA0;969:             <span class="c">#sum_count = 0.0</span></pre>
<pre class='cython line score-0'>&#xA0;970:             <span class="c">#for j in range(indptr[i],indptr[i+1]):</span></pre>
<pre class='cython line score-0'>&#xA0;971:                 <span class="c">#idx = indices[j]</span></pre>
<pre class='cython line score-0'>&#xA0;972:                 <span class="c">#coef = ccoef[j]</span></pre>
<pre class='cython line score-0'>&#xA0;973:                 <span class="c">#data = cdata[idx]</span></pre>
<pre class='cython line score-0'>&#xA0;974:                 <span class="c">#if do_dummy and data==cdummy:</span></pre>
<pre class='cython line score-0'>&#xA0;975:                     <span class="c">#continue</span></pre>
<pre class='cython line score-0'>&#xA0;976: </pre>
<pre class='cython line score-0'>&#xA0;977:                 <span class="c">#sum_data = sum_data + coef * data</span></pre>
<pre class='cython line score-0'>&#xA0;978:                 <span class="c">#sum_count = sum_count + coef</span></pre>
<pre class='cython line score-0'>&#xA0;979:             <span class="c">#outData_1d[i] += sum_data</span></pre>
<pre class='cython line score-0'>&#xA0;980:             <span class="c">#outCount_1d[i] += sum_count</span></pre>
<pre class='cython line score-0'>&#xA0;981:             <span class="c">#if sum_count &gt; epsilon:</span></pre>
<pre class='cython line score-0'>&#xA0;982:                 <span class="c">#outMerge_1d[i] += sum_data / sum_count</span></pre>
<pre class='cython line score-0'>&#xA0;983:             <span class="c">#else:</span></pre>
<pre class='cython line score-0'>&#xA0;984:                 <span class="c">#outMerge_1d[i] += cdummy</span></pre>
<pre class='cython line score-0'>&#xA0;985:         <span class="c">#return  outMerge.T, self.outPos0, self.outPos1, outData.T, outCount.T</span></pre>
<pre class='cython line score-0'>&#xA0;986: </pre>
</div></body></html>



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Calibration tool: pyFAI-recalib &mdash; pyFAI v0.9.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyFAI v0.9.0 documentation" href="../index.html" />
    <link rel="up" title="pyFAI scripts manual" href="scripts.html" />
    <link rel="next" title="Integration tool: pyFAI-integrate" href="pyFAI-integrate.html" />
    <link rel="prev" title="Calibration tool: pyFAI-calib" href="pyFAI-calib.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyFAI-integrate.html" title="Integration tool: pyFAI-integrate"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyFAI-calib.html" title="Calibration tool: pyFAI-calib"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pyFAI v0.9.0 documentation</a> &raquo;</li>
          <li><a href="scripts.html" accesskey="U">pyFAI scripts manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="calibration-tool-pyfai-recalib">
<h1>Calibration tool: pyFAI-recalib<a class="headerlink" href="#calibration-tool-pyfai-recalib" title="Permalink to this headline">¶</a></h1>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>Calibrate the diffraction setup geometry based on Debye-Sherrer rings images
with a priori knowledge of your setup (an input PONI-file).
You will need a &#8220;d-spacing&#8221; file containing the spacing of Miller plans in
Angstrom (in decreasing order).
If you are using a standart calibrant, look at
<a class="reference external" href="https://github.com/kif/pyFAI/tree/master/calibration">https://github.com/kif/pyFAI/tree/master/calibration</a>
or search in the American Mineralogist database:
<a class="reference external" href="http://rruff.geo.arizona.edu/AMS/amcsd.php">http://rruff.geo.arizona.edu/AMS/amcsd.php</a></p>
<dl class="docutils">
<dt>You will need in addition:</dt>
<dd><ul class="first last simple">
<li>The radiation energy (in keV) or its wavelength (in A)</li>
</ul>
</dd>
<dt>Many option are available among those:</dt>
<dd><ul class="first last simple">
<li>dark-current / flat field corrections</li>
<li>Masking of bad regions</li>
<li>Polarization correction</li>
<li>Automatic desaturation (time consuming!)</li>
<li>Intensity weighted least-squares refinements</li>
</ul>
</dd>
</dl>
<p>The output of this program is a &#8220;PONI&#8221; file containing the detector description
and the 6 refined parameters (distance, center, rotation) and wavelength.
An 1D and 2D diffraction patterns are also produced. (.dat and .azim files)</p>
<p>The main difference with pyFAI-calib is the way control-point hence Debye-Sherrer
rings are extracted. While pyFAI-calib relies on the contiguity of a region of peaks
called massif; pyFAI-recalib knows approximatly the geometry and is able to select
the region where the ring should be. From this region it selects automatically
the various peaks; making pyFAI-recalib able to run without graphical interface and
without human intervention (&#8211;no-gui &#8211;no-interactive options).</p>
</div>
<div class="section" id="usage">
<h2>Usage:<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>pyFAI-recalib [options] -w 1 -p imagefile.poni -S calibrant.D imagefile.edf</p>
</div>
<div class="section" id="options">
<h2>Options:<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></td>
<td>show  help message and exit</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-V</span>, <span class="option">--version</span></kbd></td>
<td>print version of the program and quit</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-o <var>FILE</var></span>, <span class="option">--out=<var>FILE</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Filename where processed image is saved</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-v</span>, <span class="option">--verbose</span></kbd></td>
<td>switch to debug/verbose mode</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-S <var>FILE</var></span>, <span class="option">--spacing=<var>FILE</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>file containing d-spacing of the reference sample
(MANDATORY)</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-w <var>WAVELENGTH</var></span>, <span class="option">--wavelength=<var>WAVELENGTH</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>wavelength of the X-Ray beam in Angstrom</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-e <var>ENERGY</var></span>, <span class="option">--energy=<var>ENERGY</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>energy of the X-Ray beam in keV (hc=12.398419292keV.A)</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-P <var>POLARIZATION_FACTOR</var></span>, <span class="option">--polarization=<var>POLARIZATION_FACTOR</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>polarization factor, from -1 (vertical) to +1
(horizontal), default is None (no correction),
synchrotrons are around 0.95</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-b <var>BACKGROUND</var></span>, <span class="option">--background=<var>BACKGROUND</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Automatic background subtraction if no value are
provided</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-d <var>DARK</var></span>, <span class="option">--dark=<var>DARK</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>list of dark images to average and subtract</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-f <var>FLAT</var></span>, <span class="option">--flat=<var>FLAT</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>list of flat images to average and divide</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-s <var>SPLINE</var></span>, <span class="option">--spline=<var>SPLINE</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>spline file describing the detector distortion</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-D <var>DETECTOR_NAME</var></span>, <span class="option">--detector=<var>DETECTOR_NAME</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Detector name (instead of pixel size+spline)</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-m <var>MASK</var></span>, <span class="option">--mask=<var>MASK</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>file containing the mask (for image reconstruction)</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-n <var>NPT</var></span>, <span class="option">--pt=<var>NPT</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>file with datapoints saved. Default: basename.npt</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--filter=<var>FILTER</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>select the filter, either mean(default), max or median</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-l <var>DISTANCE</var></span>, <span class="option">--distance=<var>DISTANCE</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>sample-detector distance in millimeter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--poni1=<var>PONI1</var></span></kbd></td>
<td>poni1 coordinate in meter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--poni2=<var>PONI2</var></span></kbd></td>
<td>poni2 coordinate in meter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--rot1=<var>ROT1</var></span></kbd></td>
<td>rot1 in radians</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--rot2=<var>ROT2</var></span></kbd></td>
<td>rot2 in radians</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--rot3=<var>ROT3</var></span></kbd></td>
<td>rot3 in radians</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-dist</span></kbd></td>
<td>fix the distance parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-dist</span></kbd></td>
<td>free the distance parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-poni1</span></kbd></td>
<td>fix the poni1 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-poni1</span></kbd></td>
<td>free the poni1 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-poni2</span></kbd></td>
<td>fix the poni2 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-poni2</span></kbd></td>
<td>free the poni2 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-rot1</span></kbd></td>
<td>fix the rot1 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-rot1</span></kbd></td>
<td>free the rot1 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-rot2</span></kbd></td>
<td>fix the rot2 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-rot2</span></kbd></td>
<td>free the rot2 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fix-rot3</span></kbd></td>
<td>fix the rot3 parameter</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--free-rot3</span></kbd></td>
<td>free the rot3 parameter</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--fix-wavelength</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>fix the wavelength parameter</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--free-wavelength</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>free the wavelength parameter</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--saturation=<var>SATURATION</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>consider all pixel&gt;max*(1-saturation) as saturated and
reconstruct them</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--weighted</span></kbd></td>
<td>weight fit by intensity, by default not.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--npt=<var>NPT_1D</var></span></kbd></td>
<td>Number of point in 1D integrated pattern, Default:
1024</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--npt-azim=<var>NPT_2D_AZIM</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Number of azimuthal sectors in 2D integrated images.
Default: 360</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--npt-rad=<var>NPT_2D_RAD</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Number of radial bins in 2D integrated images.
Default: 400</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--unit=<var>UNIT</var></span></kbd></td>
<td>Valid units for radial range: 2th_deg, 2th_rad,
q_nm^-1, q_A^-1, r_mm. Default: 2th_deg</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--no-gui</span></kbd></td>
<td>force the program to run without a Graphical interface</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--no-interactive</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>force the program to run and exit without prompting
for refinements</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-r <var>MAX_RINGS</var></span>, <span class="option">--ring=<var>MAX_RINGS</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>maximum number of rings to extract. Default: all
accessible</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-p <var>FILE</var></span>, <span class="option">--poni=<var>FILE</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>file containing the diffraction parameter (poni-file).
MANDATORY</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-k</span>, <span class="option">--keep</span></kbd></td>
<td>Keep existing control point and append new</td></tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="tips-tricks">
<h2>Tips &amp; Tricks<a class="headerlink" href="#tips-tricks" title="Permalink to this headline">¶</a></h2>
<p>PONI files are ASCII files and each new refinement adds an entry int the file.
So if you are unhappy with the last step, just edit this file and remove the last
entry (timestamps will help you).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calibration tool: pyFAI-recalib</a><ul>
<li><a class="reference internal" href="#purpose">Purpose</a></li>
<li><a class="reference internal" href="#usage">Usage:</a></li>
<li><a class="reference internal" href="#options">Options:</a></li>
<li><a class="reference internal" href="#tips-tricks">Tips &amp; Tricks</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pyFAI-calib.html"
                        title="previous chapter">Calibration tool: pyFAI-calib</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pyFAI-integrate.html"
                        title="next chapter">Integration tool: pyFAI-integrate</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/man/pyFAI-recalib.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyFAI-integrate.html" title="Integration tool: pyFAI-integrate"
             >next</a> |</li>
        <li class="right" >
          <a href="pyFAI-calib.html" title="Calibration tool: pyFAI-calib"
             >previous</a> |</li>
        <li><a href="../index.html">pyFAI v0.9.0 documentation</a> &raquo;</li>
          <li><a href="scripts.html" >pyFAI scripts manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jerome Kieffer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
  </body>
</html>